import{_ as w,r as y,z as g,i as C,c as l,o as n,a as t,t as c,q as $,k as V,F as x,s as I,n as L,B as F,f as P,x as S,A as N,b as U,y as B,g as z,d as k,e as T}from"./index-CajTN6Mj.js";const M={class:"tax-summary"},Y={class:"header-row"},R={class:"fy-selector"},G={class:"grid-cards"},E={class:"summary-card"},j={class:"value"},H={class:"summary-card"},O={class:"value"},W={class:"subtext"},q={class:"summary-card highlight"},Q={class:"value"},J={class:"summary-card info"},K={class:"value"},X={__name:"TaxSummary",props:{portfolioId:String},setup(b){const i=b,a=y(new Date().getFullYear()+(new Date().getMonth()>5?1:0)),r=y({realizedGains:0,dividends:0,frankingCredits:0}),d=async()=>{if(i.portfolioId)try{const f=await $.get(`/reports/tax-summary/${i.portfolioId}`,{params:{fiscalYear:a.value}});r.value=f.data}catch(f){console.error(f)}};g(()=>i.portfolioId,d),g(a,d);const v=f=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD"}).format(f||0);return C(d),(f,e)=>(n(),l("div",M,[t("div",Y,[t("h3",null,"Tax Summary (FY "+c(a.value)+")",1),t("div",R,[t("button",{onClick:e[0]||(e[0]=p=>a.value--),class:"btn-icon"},"←"),t("span",null,c(a.value-1)+" - "+c(a.value),1),t("button",{onClick:e[1]||(e[1]=p=>a.value++),class:"btn-icon"},"→")])]),t("div",G,[t("div",E,[e[2]||(e[2]=t("div",{class:"label"},"Realized Capital Gains",-1)),t("div",j,c(v(r.value.realizedGains)),1),e[3]||(e[3]=t("div",{class:"subtext"},"From asset sales",-1))]),t("div",H,[e[4]||(e[4]=t("div",{class:"label"},"Dividends",-1)),t("div",O,c(v(r.value.dividends)),1),t("div",W,"+ "+c(v(r.value.frankingCredits))+" Franking Credits",1)]),t("div",q,[e[5]||(e[5]=t("div",{class:"label"},"Est. Tax Liability",-1)),t("div",Q,c(v((r.value.realizedGains+r.value.dividends+r.value.frankingCredits)*.3)),1),e[6]||(e[6]=t("div",{class:"subtext"},"@ 30% Marginal Rate",-1))]),t("div",J,[e[7]||(e[7]=t("div",{class:"label"},"Gross Income",-1)),t("div",K,c(v(r.value.realizedGains+r.value.dividends+r.value.frankingCredits)),1),e[8]||(e[8]=t("div",{class:"subtext"},"Total Taxable Income",-1))])])]))}},Z=w(X,[["__scopeId","data-v-ad20570d"]]),tt={class:"performance-chart card"},et={class:"chart-header"},at={class:"range-selector"},st=["onClick"],ot={class:"chart-container"},nt={key:1,class:"empty-chart"},lt={__name:"PerformanceChart",props:{portfolioId:String},setup(b){const i=b,a=y("1Y"),r=["1M","3M","6M","1Y","3Y","5Y","ALL"],d=y([]),v=V(()=>[{name:"Portfolio Value",data:d.value.map(s=>[new Date(s.date).getTime(),s.totalValue])}]),f=V(()=>({chart:{type:"area",toolbar:{show:!1},animations:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.3}},xaxis:{type:"datetime",tooltip:{enabled:!1}},yaxis:{labels:{formatter:s=>"$"+(s/1e3).toFixed(1)+"k"}},theme:{mode:"dark",palette:"palette1"},colors:["#3b82f6"],grid:{borderColor:"#333"}})),e=async()=>{if(i.portfolioId)try{const s=await $.get(`/reports/performance/${i.portfolioId}`,{params:{range:a.value}});d.value=s.data}catch(s){console.error(s)}},p=async()=>{if(i.portfolioId)try{await $.post(`/reports/rebuild-history/${i.portfolioId}`),await e()}catch(s){console.error(s)}};return g(()=>i.portfolioId,e),g(a,e),C(e),(s,h)=>{const m=P("apexchart");return n(),l("div",tt,[t("div",et,[h[0]||(h[0]=t("h3",null,"Portfolio Performance",-1)),t("div",at,[(n(),l(x,null,I(r,o=>t("button",{key:o,class:L({active:a.value===o}),onClick:u=>a.value=o},c(o),11,st)),64))])]),t("div",ot,[v.value[0].data.length>0?(n(),F(m,{key:0,type:"area",height:"350",options:f.value,series:v.value},null,8,["options","series"])):(n(),l("div",nt,[h[1]||(h[1]=t("p",null,"No performance data available.",-1)),t("button",{onClick:p,class:"btn btn-primary btn-sm"},"Build History")]))])])}}},it=w(lt,[["__scopeId","data-v-88c77be3"]]),rt={class:"transaction-ledger card"},dt={class:"toolbar"},ct={class:"filters"},ut={class:"data-table"},vt={key:0},pt={class:"asset-cell"},mt={class:"symbol"},ft={class:"name text-muted"},yt={class:"text-right"},_t={class:"text-right font-mono"},ht={class:"small-text"},bt={key:1},gt={key:2},$t={__name:"TransactionLedger",props:{portfolioId:String},setup(b){const i=b,a=y([]),r=y(!0),d=y(""),v=y(""),f=async()=>{if(i.portfolioId){r.value=!0;try{const m={};d.value&&(m.type=d.value),v.value&&(m.search=v.value);const o=await $.get(`/reports/transactions/${i.portfolioId}`,{params:m});a.value=o.data}catch(m){console.error("Failed to load transactions",m)}finally{r.value=!1}}};g(()=>i.portfolioId,f),g([d,v],()=>{f()});const e=m=>new Date(m).toLocaleDateString("en-AU"),p=m=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD"}).format(m),s=m=>{switch(m){case"Buy":return"badge-info";case"Sell":return"badge-warning";case"Dividend":return"badge-success";default:return"badge-neutral"}},h=()=>{const m=["Date","Type","Symbol","Units","Amount","Narration"],o=a.value.map(_=>[new Date(_.effectiveDate).toLocaleDateString(),_.type,_.assetCode,_.units,_.amount,`"${_.narration}"`]),u=[m.join(","),...o.map(_=>_.join(","))].join(`
`),A=new Blob([u],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a");D.href=URL.createObjectURL(A),D.download=`transactions_${i.portfolioId}.csv`,D.click()};return C(f),(m,o)=>(n(),l("div",rt,[t("div",dt,[t("div",ct,[S(t("select",{"onUpdate:modelValue":o[0]||(o[0]=u=>d.value=u),class:"form-select"},[...o[2]||(o[2]=[U('<option value="" data-v-3f95e2e7>All Types</option><option value="Buy" data-v-3f95e2e7>Buy</option><option value="Sell" data-v-3f95e2e7>Sell</option><option value="Dividend" data-v-3f95e2e7>Dividend</option><option value="Deposit" data-v-3f95e2e7>Deposit</option><option value="Withdrawal" data-v-3f95e2e7>Withdrawal</option>',6)])],512),[[N,d.value]]),S(t("input",{"onUpdate:modelValue":o[1]||(o[1]=u=>v.value=u),type:"text",placeholder:"Search items...",class:"form-input"},null,512),[[B,v.value]])]),t("button",{class:"btn btn-secondary",onClick:h},[...o[3]||(o[3]=[t("span",{class:"icon"},"↓",-1),z(" Export CSV ",-1)])])]),t("table",ut,[o[6]||(o[6]=t("thead",null,[t("tr",null,[t("th",null,"Date"),t("th",null,"Type"),t("th",null,"Asset"),t("th",{class:"text-right"},"Units"),t("th",{class:"text-right"},"Amount"),t("th",null,"Narration")])],-1)),!r.value&&a.value.length>0?(n(),l("tbody",vt,[(n(!0),l(x,null,I(a.value,u=>(n(),l("tr",{key:u.id},[t("td",null,c(e(u.effectiveDate)),1),t("td",null,[t("span",{class:L(["badge",s(u.type)])},c(u.type),3)]),t("td",null,[t("div",pt,[t("span",mt,c(u.assetCode),1),t("span",ft,c(u.assetName),1)])]),t("td",yt,c(u.units!==0?u.units.toLocaleString():"-"),1),t("td",_t,c(p(u.amount)),1),t("td",ht,c(u.narration),1)]))),128))])):r.value?(n(),l("tbody",bt,[...o[4]||(o[4]=[t("tr",null,[t("td",{colspan:"6",class:"text-center"},"Loading...")],-1)])])):(n(),l("tbody",gt,[...o[5]||(o[5]=[t("tr",null,[t("td",{colspan:"6",class:"text-center text-muted"},"No transactions found")],-1)])]))])]))}},kt=w($t,[["__scopeId","data-v-3f95e2e7"]]),xt={class:"reports-view animate-fade-in content-container"},It={class:"page-header mb-lg"},wt={class:"controls"},Ct={class:"select-wrapper"},Dt=["value"],Tt={key:0},St={class:"tabs mb-lg"},Lt=["onClick"],Vt={class:"tab-content"},Nt={key:0,class:"animate-fade-in"},At={key:1,class:"animate-fade-in"},Ft={key:2,class:"animate-fade-in"},Pt={key:1,class:"loading-state card"},Ut={key:0,class:"spinner"},Bt={key:1,class:"text-muted"},zt={__name:"ReportsView",setup(b){const i=y([]),a=y(null),r=y(!0),d=y("performance"),v=[{id:"performance",label:"Performance"},{id:"tax",label:"Tax Center"},{id:"transactions",label:"Ledger"}];return C(async()=>{try{const e=await $.get("/portfolios");i.value=e.data,i.value.length>0&&(a.value=i.value[0].id)}catch(e){console.error("Failed to load portfolios",e)}finally{r.value=!1}}),(e,p)=>(n(),l("div",xt,[t("div",It,[p[1]||(p[1]=t("div",null,[t("h1",null,"Reports & Analysis"),t("p",{class:"text-muted"},"Track performance, tax liabilities, and transaction history.")],-1)),t("div",wt,[t("div",Ct,[i.value.length>0?S((n(),l("select",{key:0,"onUpdate:modelValue":p[0]||(p[0]=s=>a.value=s),class:"portfolio-select"},[(n(!0),l(x,null,I(i.value,s=>(n(),l("option",{key:s.id,value:s.id},c(s.name),9,Dt))),128))],512)),[[N,a.value]]):k("",!0)])])]),a.value?(n(),l("div",Tt,[t("div",St,[(n(),l(x,null,I(v,s=>t("button",{key:s.id,class:L(["tab-btn",{active:d.value===s.id}]),onClick:h=>d.value=s.id},c(s.label),11,Lt)),64))]),t("div",Vt,[d.value==="performance"?(n(),l("div",Nt,[p[2]||(p[2]=t("div",{class:"section-header mb-md"},[t("h2",null,"Portfolio Performance"),t("p",{class:"text-muted"},"Visualizing portfolio value and growth over time versus invested capital.")],-1)),T(it,{portfolioId:a.value},null,8,["portfolioId"])])):k("",!0),d.value==="tax"?(n(),l("div",At,[p[3]||(p[3]=t("div",{class:"section-header mb-md"},[t("h2",null,"Tax Impact"),t("p",{class:"text-muted"},"Estimated tax liabilities, realized gains, and franking credits for the financial year.")],-1)),T(Z,{portfolioId:a.value},null,8,["portfolioId"])])):k("",!0),d.value==="transactions"?(n(),l("div",Ft,[p[4]||(p[4]=t("div",{class:"section-header mb-md"},[t("h2",null,"Transaction Ledger"),t("p",{class:"text-muted"},"Complete history of all buy, sell, and income events.")],-1)),T(kt,{portfolioId:a.value},null,8,["portfolioId"])])):k("",!0)])])):(n(),l("div",Pt,[r.value?(n(),l("div",Ut)):(n(),l("p",Bt,"No portfolios found. Please create one to view reports."))]))]))}},Yt=w(zt,[["__scopeId","data-v-290e6789"]]);export{Yt as default};
