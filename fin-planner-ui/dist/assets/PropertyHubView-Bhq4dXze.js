import{r as G,o as l,c as i,a as e,d as L,t as a,n as I,z as A,b as Y,F as V,e as B,l as E,f as P,g as h,w as W,s as M,m as U,p as $,v as R,C as z,q as ee,_ as te,x as se,j as oe,i as H}from"./index-oVbs5Hxd.js";import{usePortfolioStore as ae}from"./portfolio-CjZnfIUI.js";import{_ as ne}from"./MoneyBoxLoader-BOnNyVJS.js";import{P as le}from"./PropertyRiskAnalyzer-DayF37os.js";const re={class:"yield-gauge"},ie={class:"gauge-container"},de={class:"gauge-metrics"},ue={class:"metric"},ce={class:"metric-value value-positive"},pe={class:"metric"},ve={class:"metric-value value-negative"},me={class:"metric"},ye={__name:"YieldGauge",props:{yieldPercent:{type:Number,default:0},targetYield:{type:Number,default:6},grossIncome:{type:Number,default:0},expenses:{type:Number,default:0}},setup(x){const p=x,b=A(()=>p.grossIncome-p.expenses),c=A(()=>[Math.min(p.yieldPercent,12)]),S=A(()=>{const k=p.yieldPercent>=p.targetYield?"#059669":p.yieldPercent>=4?"#d97706":"#dc2626";return{chart:{type:"radialBar",sparkline:{enabled:!1},fontFamily:"Plus Jakarta Sans, Inter, sans-serif"},plotOptions:{radialBar:{startAngle:-135,endAngle:135,hollow:{size:"65%",background:"transparent"},track:{background:"var(--color-border)",strokeWidth:"100%",margin:0},dataLabels:{name:{show:!0,fontSize:"14px",fontWeight:500,color:"var(--color-text-muted)",offsetY:-15},value:{show:!0,fontSize:"32px",fontWeight:700,color:k,offsetY:5,formatter:()=>`${p.yieldPercent.toFixed(1)}%`}}}},labels:["Net Yield"],colors:[k],stroke:{lineCap:"round"},annotations:{position:"front",yaxis:[{y:p.targetYield,borderColor:"#94a3b8",strokeDashArray:4,label:{text:`Target: ${p.targetYield}%`,style:{color:"var(--color-text-muted)",fontSize:"12px"}}}]}}});function y(k){return new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(k||0)}return(k,u)=>{const n=G("apexchart");return l(),i("div",re,[e("div",ie,[L(n,{type:"radialBar",height:"280",options:S.value,series:c.value},null,8,["options","series"])]),e("div",de,[e("div",ue,[u[0]||(u[0]=e("span",{class:"metric-label"},"Gross Income",-1)),e("span",ce,a(y(x.grossIncome)),1)]),u[3]||(u[3]=e("div",{class:"metric-divider"},null,-1)),e("div",pe,[u[1]||(u[1]=e("span",{class:"metric-label"},"Expenses",-1)),e("span",ve,"-"+a(y(x.expenses)),1)]),u[4]||(u[4]=e("div",{class:"metric-divider"},null,-1)),e("div",me,[u[2]||(u[2]=e("span",{class:"metric-label"},"Net Income",-1)),e("span",{class:I(["metric-value",b.value>=0?"value-positive":"value-negative"])},a(y(b.value)),3)])])])}}},ge={class:"vacancy-heatmap"},fe={key:0,class:"empty-state"},he={__name:"VacancyHeatmap",props:{data:{type:Array,default:()=>[]}},setup(x){const p=x,b=A(()=>{const u={};return p.data.forEach(n=>{const d=new Date(n.month).toISOString().slice(0,7);u[d]||(u[d]={month:new Date(n.month),total:0,tenants:[]}),u[d].total+=n.expiringRent,u[d].tenants.push(n.tenantName)}),Object.values(u).sort((n,d)=>n.month-d.month)}),c=A(()=>[{name:"Expiring Rent",data:b.value.map(u=>({x:y(u.month),y:u.total,tenants:u.tenants}))}]),S=A(()=>{const u=new Date;return{chart:{type:"bar",toolbar:{show:!1},fontFamily:"Plus Jakarta Sans, Inter, sans-serif"},plotOptions:{bar:{borderRadius:4,columnWidth:"70%",distributed:!0}},dataLabels:{enabled:!1},xaxis:{type:"category",labels:{style:{colors:"var(--color-text-muted)",fontSize:"11px"},rotate:-45,rotateAlways:!0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:"var(--color-text-muted)",fontSize:"12px"},formatter:n=>`$${(n/1e3).toFixed(0)}k`}},colors:b.value.map(n=>{const d=k(u,n.month);return d<=6?"#dc2626":d<=12?"#d97706":"#059669"}),legend:{show:!1},tooltip:{custom:function({series:n,seriesIndex:d,dataPointIndex:_,w:C}){const r=C.config.series[0].data[_];return`
          <div style="padding: 12px; font-family: inherit;">
            <div style="font-weight: 600; margin-bottom: 8px;">${r.x}</div>
            <div style="color: var(--color-text-secondary); margin-bottom: 4px;">
              Expiring: $${r.y.toLocaleString()}
            </div>
            <div style="font-size: 12px; color: var(--color-text-muted);">
              ${r.tenants.join(", ")}
            </div>
          </div>
        `}},grid:{borderColor:"var(--color-border-subtle)",strokeDashArray:4,xaxis:{lines:{show:!1}}}}});function y(u){return new Date(u).toLocaleDateString("en-AU",{month:"short",year:"2-digit"})}function k(u,n){const d=new Date(u),_=new Date(n);return(_.getFullYear()-d.getFullYear())*12+(_.getMonth()-d.getMonth())}return(u,n)=>{const d=G("apexchart");return l(),i("div",ge,[x.data.length===0?(l(),i("div",fe,[...n[0]||(n[0]=[Y('<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg><p>No lease expirations in the next 24 months</p>',2)])])):(l(),i(V,{key:1},[L(d,{type:"bar",height:"220",options:S.value,series:c.value},null,8,["options","series"]),n[1]||(n[1]=Y('<div class="legend"><div class="legend-item"><span class="legend-color legend-danger"></span><span>Expiring &lt; 6mo</span></div><div class="legend-item"><span class="legend-color legend-warning"></span><span>Expiring 6-12mo</span></div><div class="legend-item"><span class="legend-color legend-safe"></span><span>Expiring &gt; 12mo</span></div></div>',1))],64))])}}},be={class:"cashflow-forecast"},we={class:"view-toggle"},xe={key:0,class:"empty-state"},ke={class:"summary-row"},$e={class:"summary-item"},_e={class:"summary-value value-positive"},Ce={class:"summary-item"},Pe={key:2,class:"table-container"},Ie={class:"cashflow-table"},Ae=["onClick"],De={class:"col-period"},Fe={class:"expand-btn"},Se={width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Re={key:0,points:"6 15 12 9 18 15"},Ve={key:1,points:"6 9 12 15 18 9"},Le={class:"year-label"},Ee={class:"col-value text-right value-positive"},Te={class:"col-value text-right value-negative"},Ne={class:"col-period month-label"},Me={class:"col-value text-right"},Ue={class:"col-value text-right"},Ye={__name:"CashflowForecast",props:{data:{type:Array,default:()=>[]}},setup(x){const p=x,b=h("chart"),c=h(new Set),S=A(()=>{const r={};for(const v of p.data){const F=new Date(v.month),w=F.getMonth()>=6?F.getFullYear()+1:F.getFullYear();r[w]||(r[w]={months:[],totalIncome:0,totalExpenses:0,totalNet:0}),r[w].months.push({...v,month:F}),r[w].totalIncome+=v.projectedIncome,r[w].totalExpenses+=v.projectedExpenses,r[w].totalNet+=v.netCashflow}for(const v in r)r[v].months.sort((F,w)=>F.month-w.month);return r}),y=A(()=>[{name:"Income",data:p.data.map(r=>({x:new Date(r.month).getTime(),y:r.projectedIncome}))},{name:"Expenses",data:p.data.map(r=>({x:new Date(r.month).getTime(),y:r.projectedExpenses}))},{name:"Net Cashflow",data:p.data.map(r=>({x:new Date(r.month).getTime(),y:r.netCashflow}))}]),k=A(()=>p.data.length===0?0:p.data.reduce((r,v)=>r+v.projectedIncome,0)/p.data.length),u=A(()=>p.data.length===0?0:p.data.reduce((r,v)=>r+v.netCashflow,0)/p.data.length),n=A(()=>({chart:{type:"area",toolbar:{show:!1},fontFamily:"Plus Jakarta Sans, Inter, sans-serif",stacked:!1,zoom:{enabled:!1}},colors:["#059669","#dc2626","#1e40af"],fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.4,opacityTo:.1,stops:[0,90,100]}},stroke:{curve:"smooth",width:[2,2,3]},dataLabels:{enabled:!1},xaxis:{type:"datetime",labels:{style:{colors:"var(--color-text-muted)",fontSize:"11px"},format:"MMM yy"},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:"var(--color-text-muted)",fontSize:"12px"},formatter:r=>`$${(r/1e3).toFixed(0)}k`}},legend:{position:"top",horizontalAlign:"right",fontSize:"12px",labels:{colors:"var(--color-text-secondary)"},markers:{width:10,height:10,radius:2}},tooltip:{x:{format:"MMM yyyy"},y:{formatter:r=>`$${r.toLocaleString()}`}},grid:{borderColor:"var(--color-border-subtle)",strokeDashArray:4,xaxis:{lines:{show:!1}}}}));function d(r){c.value.has(r)?c.value.delete(r):c.value.add(r),c.value=new Set(c.value)}function _(r){return new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r||0)}function C(r){return r.toLocaleDateString("en-AU",{month:"short",year:"numeric"})}return(r,v)=>{const F=G("apexchart");return l(),i("div",be,[e("div",we,[e("button",{class:I(["toggle-btn",{active:b.value==="chart"}]),onClick:v[0]||(v[0]=w=>b.value="chart")},[...v[2]||(v[2]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})],-1),B(" Chart ",-1)])],2),e("button",{class:I(["toggle-btn",{active:b.value==="table"}]),onClick:v[1]||(v[1]=w=>b.value="table")},[...v[3]||(v[3]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e("line",{x1:"3",y1:"18",x2:"21",y2:"18"})],-1),B(" Monthly ",-1)])],2)]),x.data.length===0?(l(),i("div",xe,[...v[4]||(v[4]=[e("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})],-1),e("p",null,"No cashflow data available",-1)])])):b.value==="chart"?(l(),i(V,{key:1},[L(F,{type:"area",height:"220",options:n.value,series:y.value},null,8,["options","series"]),e("div",ke,[e("div",$e,[v[5]||(v[5]=e("span",{class:"summary-label"},"Avg Monthly Income",-1)),e("span",_e,a(_(k.value)),1)]),e("div",Ce,[v[6]||(v[6]=e("span",{class:"summary-label"},"Avg Monthly Net",-1)),e("span",{class:I(["summary-value",u.value>=0?"value-positive":"value-negative"])},a(_(u.value)),3)])])],64)):(l(),i("div",Pe,[e("table",Ie,[v[7]||(v[7]=e("thead",null,[e("tr",null,[e("th",{class:"col-period"},"Period"),e("th",{class:"col-value text-right"},"Income"),e("th",{class:"col-value text-right"},"Expenses"),e("th",{class:"col-value text-right"},"Net Cashflow")])],-1)),e("tbody",null,[(l(!0),i(V,null,E(S.value,(w,g)=>(l(),i(V,{key:g},[e("tr",{class:I(["year-row",{expanded:c.value.has(g)}]),onClick:t=>d(g)},[e("td",De,[e("button",Fe,[(l(),i("svg",Se,[c.value.has(g)?(l(),i("polyline",Re)):(l(),i("polyline",Ve))]))]),e("span",Le,"FY "+a(g),1)]),e("td",Ee,a(_(w.totalIncome)),1),e("td",Te,a(_(w.totalExpenses)),1),e("td",{class:I(["col-value text-right",w.totalNet>=0?"value-positive":"value-negative"])},a(_(w.totalNet)),3)],10,Ae),c.value.has(g)?(l(!0),i(V,{key:0},E(w.months,t=>(l(),i("tr",{key:t.month.toISOString(),class:"month-row"},[e("td",Ne,a(C(t.month)),1),e("td",Me,a(_(t.projectedIncome)),1),e("td",Ue,a(_(t.projectedExpenses)),1),e("td",{class:I(["col-value text-right",t.netCashflow>=0?"value-positive":"value-negative"])},a(_(t.netCashflow)),3)]))),128)):P("",!0)],64))),128))])])]))])}}},Be={class:"property-header"},Oe={class:"property-body"},qe={class:"property-address"},ze={class:"property-value"},Ge={class:"property-footer"},je={class:"footer-item"},He={__name:"PropertyCard",props:{property:{type:Object,required:!0}},emits:["click"],setup(x){const p=x,b=A(()=>({"type-office":p.property.buildingType==="Office","type-retail":p.property.buildingType==="Retail","type-industrial":p.property.buildingType==="Industrial","type-mixed":p.property.buildingType==="Mixed"})),c=A(()=>{const n=p.property.netYieldPercent;return n>=6?"yield-good":n>=4?"yield-medium":"yield-low"}),S=A(()=>{if(!p.property.nextLeaseExpiry)return"";const n=u(new Date,new Date(p.property.nextLeaseExpiry));return n<=6?"expiry-urgent":n<=12?"expiry-warning":""});function y(n){return new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(n||0)}function k(n){const d=new Date(n),C=u(new Date,d);return C<=0?"Expired":C===1?"Exp. 1mo":C<12?`Exp. ${C}mo`:d.toLocaleDateString("en-AU",{month:"short",year:"2-digit"})}function u(n,d){return(d.getFullYear()-n.getFullYear())*12+(d.getMonth()-n.getMonth())}return(n,d)=>(l(),i("div",{class:"property-card",onClick:d[0]||(d[0]=_=>n.$emit("click"))},[e("div",Be,[e("div",{class:I(["property-type-badge",b.value])},a(x.property.buildingType),3),e("div",{class:I(["property-yield",c.value])},a(x.property.netYieldPercent.toFixed(1))+"% ",3)]),e("div",Oe,[e("h4",qe,a(x.property.address),1),e("div",ze,a(y(x.property.currentValue)),1)]),e("div",Ge,[e("div",je,[d[1]||(d[1]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})],-1)),e("span",null,a(x.property.leaseCount)+" "+a(x.property.leaseCount===1?"lease":"leases"),1)]),x.property.nextLeaseExpiry?(l(),i("div",{key:0,class:I(["footer-item",S.value])},[d[2]||(d[2]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12 6 12 12 16 14"})],-1)),e("span",null,a(k(x.property.nextLeaseExpiry)),1)],2)):P("",!0)]),d[3]||(d[3]=e("div",{class:"property-arrow"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"9 18 15 12 9 6"})])],-1))]))}},We={class:"drawer animate-slide-in"},Je={class:"drawer-header"},Ke={class:"header-content"},Ze={class:"drawer-title"},Qe={key:0,class:"type-badge"},Xe={key:0,class:"drawer-loading"},et={class:"tabs"},tt=["onClick"],st={class:"drawer-content"},ot={key:0,class:"tab-content"},at={class:"overview-grid"},nt={class:"overview-card"},lt={class:"overview-value value-large"},rt={class:"overview-card"},it={class:"overview-value"},dt={class:"overview-card"},ut={class:"overview-card"},ct={class:"overview-value"},pt={class:"overview-card full-width"},vt={class:"overview-value"},mt={key:0,class:"overview-card full-width"},yt={class:"overview-value text-muted"},gt={class:"section"},ft={class:"section-header"},ht={class:"form-row"},bt=["disabled"],wt={class:"valuations-list"},xt={class:"valuation-date"},kt={class:"valuation-value"},$t={class:"valuation-source badge"},_t={key:0,class:"empty-state-small"},Ct={key:1,class:"tab-content"},Pt={key:2,class:"tab-content"},It={class:"section-header"},At={class:"form-group"},Dt={class:"form-row-2"},Ft={class:"form-group"},St={class:"form-group"},Rt={class:"form-row-2"},Vt={class:"form-group"},Lt={class:"form-group"},Et={class:"form-row-2"},Tt={class:"form-group"},Nt={class:"form-group"},Mt=["disabled"],Ut={class:"leases-list"},Yt={class:"lease-header"},Bt={class:"lease-tenant"},Ot={class:"lease-details"},qt={class:"lease-detail"},zt={class:"lease-detail"},Gt={class:"lease-detail"},jt={key:0,class:"empty-state-small"},Ht={key:3,class:"tab-content"},Wt={class:"section-header"},Jt={class:"form-row-ledger"},Kt={class:"checkbox-label"},Zt=["disabled"],Qt={class:"ledger-list"},Xt={class:"ledger-date"},es={class:"ledger-type"},ts={key:0,class:"empty-state-small"},ss={__name:"PropertyDetailDrawer",props:{propertyId:{type:String,required:!0}},emits:["close","updated"],setup(x,{emit:p}){const b=x,c=p,S=h(!0),y=h(null),k=h([]),u=h([]),n=h([]),d=h("overview"),_=[{id:"overview",label:"Overview"},{id:"risk",label:"Risk Analysis"},{id:"leases",label:"Leases"},{id:"ledger",label:"Ledger"}],C=h(!1),r=h(!1),v=h(!1),F=h(!1),w=h(!1),g=h(!1),t=h({date:new Date().toISOString().split("T")[0],value:0,source:""}),D=h({tenantName:"",leaseStart:"",leaseEnd:"",currentRent:0,reviewType:"",optionPeriod:"",unitReference:""}),m=h({date:new Date().toISOString().split("T")[0],type:"",amount:0,isIncome:!1}),T=A(()=>k.value.length>0?k.value[0].value:y.value?.purchasePrice||0),j=A(()=>T.value-(y.value?.purchasePrice||0)),J=A(()=>{if(!y.value)return{};y.value;const f=u.value.filter(s=>s.isActive).reduce((s,o)=>s+(o.currentRent||0),0);return{propertyValue:T.value,currentValue:T.value,askingPrice:T.value,estimatedGrossRent:f,annualRent:f,outgoingsEstimate:0,vacancyRatePercent:5,capitalGrowthPercent:3,loanAmount:0,interestRatePercent:6.5,holdingPeriodYears:10,discountRate:8}});W(()=>b.propertyId,f=>{f&&O()},{immediate:!0});async function O(){try{S.value=!0;const f=await M.get(`/commercialproperty/${b.propertyId}`);y.value=f.data,k.value=f.data.valuations||[],u.value=f.data.leases||[],n.value=f.data.ledgerEntries||[]}catch(f){console.error("Failed to load property:",f)}finally{S.value=!1}}async function K(){try{F.value=!0,await M.post(`/commercialproperty/${b.propertyId}/valuations`,t.value),await O(),C.value=!1,t.value={date:new Date().toISOString().split("T")[0],value:0,source:""},c("updated")}catch(f){console.error("Failed to add valuation:",f)}finally{F.value=!1}}async function Z(){try{w.value=!0,await M.post(`/commercialproperty/${b.propertyId}/leases`,D.value),await O(),r.value=!1,D.value={tenantName:"",leaseStart:"",leaseEnd:"",currentRent:0,reviewType:"",optionPeriod:"",unitReference:""},c("updated")}catch(f){console.error("Failed to add lease:",f)}finally{w.value=!1}}async function Q(){try{g.value=!0,await M.post(`/commercialproperty/${b.propertyId}/ledger`,m.value),await O(),v.value=!1,m.value={date:new Date().toISOString().split("T")[0],type:"",amount:0,isIncome:!1},c("updated")}catch(f){console.error("Failed to add ledger entry:",f)}finally{g.value=!1}}function N(f){return new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(f||0)}function q(f){return new Date(f).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}function X(f){return f.replace(/_/g," ").replace(/([A-Z])/g," $1").trim()}return(f,s)=>(l(),i("div",{class:"drawer-backdrop",onClick:s[18]||(s[18]=U(o=>f.$emit("close"),["self"]))},[e("aside",We,[e("div",Je,[e("div",Ke,[e("h2",Ze,a(y.value?.address||"Loading..."),1),y.value?(l(),i("span",Qe,a(y.value.buildingType),1)):P("",!0)]),e("button",{class:"btn-close",onClick:s[0]||(s[0]=o=>f.$emit("close"))},[...s[19]||(s[19]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),S.value?(l(),i("div",Xe,[...s[20]||(s[20]=[e("div",{class:"spinner"},null,-1),e("span",null,"Loading property details...",-1)])])):y.value?(l(),i(V,{key:1},[e("div",et,[(l(),i(V,null,E(_,o=>e("button",{key:o.id,class:I(["tab",{active:d.value===o.id}]),onClick:zs=>d.value=o.id},a(o.label),11,tt)),64))]),e("div",st,[d.value==="overview"?(l(),i("div",ot,[e("div",at,[e("div",nt,[s[21]||(s[21]=e("span",{class:"overview-label"},"Current Value",-1)),e("span",lt,a(N(T.value)),1)]),e("div",rt,[s[22]||(s[22]=e("span",{class:"overview-label"},"Purchase Price",-1)),e("span",it,a(N(y.value.purchasePrice)),1)]),e("div",dt,[s[23]||(s[23]=e("span",{class:"overview-label"},"Capital Growth",-1)),e("span",{class:I(["overview-value",j.value>=0?"value-positive":"value-negative"])},a(j.value>=0?"+":"")+a(N(j.value)),3)]),e("div",ut,[s[24]||(s[24]=e("span",{class:"overview-label"},"Total GFA",-1)),e("span",ct,a(y.value.totalGFA?.toLocaleString()||"—")+" m²",1)]),e("div",pt,[s[25]||(s[25]=e("span",{class:"overview-label"},"Title Reference",-1)),e("span",vt,a(y.value.titleReference||"—"),1)]),y.value.description?(l(),i("div",mt,[s[26]||(s[26]=e("span",{class:"overview-label"},"Description",-1)),e("span",yt,a(y.value.description),1)])):P("",!0)]),e("div",gt,[e("div",ft,[s[27]||(s[27]=e("h3",null,"Valuation History",-1)),e("button",{class:"btn btn-secondary btn-sm",onClick:s[1]||(s[1]=o=>C.value=!C.value)},a(C.value?"Cancel":"+ Add Valuation"),1)]),C.value?(l(),i("form",{key:0,class:"inline-form",onSubmit:U(K,["prevent"])},[e("div",ht,[$(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.date=o),type:"date",required:""},null,512),[[R,t.value.date]]),$(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.value.value=o),type:"number",placeholder:"Value",required:""},null,512),[[R,t.value.value,void 0,{number:!0}]]),$(e("select",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.value.source=o),required:""},[...s[28]||(s[28]=[e("option",{value:""},"Source",-1),e("option",{value:"Agent"},"Agent",-1),e("option",{value:"External"},"External",-1),e("option",{value:"Internal"},"Internal",-1)])],512),[[z,t.value.source]]),e("button",{type:"submit",class:"btn btn-primary btn-sm",disabled:F.value},"Add",8,bt)])],32)):P("",!0),e("div",wt,[(l(!0),i(V,null,E(k.value,o=>(l(),i("div",{key:o.id,class:"valuation-item"},[e("div",xt,a(q(o.date)),1),e("div",kt,a(N(o.value)),1),e("div",$t,a(o.source),1)]))),128)),k.value.length===0?(l(),i("div",_t," No valuations recorded ")):P("",!0)])])])):P("",!0),d.value==="risk"?(l(),i("div",Ct,[s[29]||(s[29]=e("div",{class:"risk-intro"},[e("p",null,"Run a Monte Carlo simulation on this property to understand its risk profile over time.")],-1)),L(le,{"initial-data":J.value,"auto-run":!1},null,8,["initial-data"])])):P("",!0),d.value==="leases"?(l(),i("div",Pt,[e("div",It,[s[30]||(s[30]=e("h3",null,"Lease Profiles",-1)),e("button",{class:"btn btn-secondary btn-sm",onClick:s[5]||(s[5]=o=>r.value=!r.value)},a(r.value?"Cancel":"+ Add Lease"),1)]),r.value?(l(),i("form",{key:0,class:"lease-form",onSubmit:U(Z,["prevent"])},[e("div",At,[s[31]||(s[31]=e("label",null,"Tenant Name *",-1)),$(e("input",{"onUpdate:modelValue":s[6]||(s[6]=o=>D.value.tenantName=o),type:"text",required:""},null,512),[[R,D.value.tenantName]])]),e("div",Dt,[e("div",Ft,[s[32]||(s[32]=e("label",null,"Lease Start *",-1)),$(e("input",{"onUpdate:modelValue":s[7]||(s[7]=o=>D.value.leaseStart=o),type:"date",required:""},null,512),[[R,D.value.leaseStart]])]),e("div",St,[s[33]||(s[33]=e("label",null,"Lease End *",-1)),$(e("input",{"onUpdate:modelValue":s[8]||(s[8]=o=>D.value.leaseEnd=o),type:"date",required:""},null,512),[[R,D.value.leaseEnd]])])]),e("div",Rt,[e("div",Vt,[s[34]||(s[34]=e("label",null,"Current Rent (p.a.) *",-1)),$(e("input",{"onUpdate:modelValue":s[9]||(s[9]=o=>D.value.currentRent=o),type:"number",required:""},null,512),[[R,D.value.currentRent,void 0,{number:!0}]])]),e("div",Lt,[s[36]||(s[36]=e("label",null,"Review Type *",-1)),$(e("select",{"onUpdate:modelValue":s[10]||(s[10]=o=>D.value.reviewType=o),required:""},[...s[35]||(s[35]=[e("option",{value:""},"Select",-1),e("option",{value:"Fixed"},"Fixed",-1),e("option",{value:"CPI"},"CPI",-1),e("option",{value:"Market"},"Market",-1)])],512),[[z,D.value.reviewType]])])]),e("div",Et,[e("div",Tt,[s[37]||(s[37]=e("label",null,"Option Period",-1)),$(e("input",{"onUpdate:modelValue":s[11]||(s[11]=o=>D.value.optionPeriod=o),type:"text",placeholder:"e.g., 5+5"},null,512),[[R,D.value.optionPeriod]])]),e("div",Nt,[s[38]||(s[38]=e("label",null,"Unit Reference",-1)),$(e("input",{"onUpdate:modelValue":s[12]||(s[12]=o=>D.value.unitReference=o),type:"text",placeholder:"e.g., Ground Floor"},null,512),[[R,D.value.unitReference]])])]),e("button",{type:"submit",class:"btn btn-primary",disabled:w.value},a(w.value?"Adding...":"Add Lease"),9,Mt)],32)):P("",!0),e("div",Ut,[(l(!0),i(V,null,E(u.value,o=>(l(),i("div",{key:o.id,class:I(["lease-item",{inactive:!o.isActive}])},[e("div",Yt,[e("span",Bt,a(o.tenantName),1),e("span",{class:I(["lease-status",{active:o.isActive}])},a(o.isActive?"Active":"Inactive"),3)]),e("div",Ot,[e("div",qt,[s[39]||(s[39]=e("span",{class:"detail-label"},"Term",-1)),e("span",null,a(q(o.leaseStart))+" — "+a(q(o.leaseEnd)),1)]),e("div",zt,[s[40]||(s[40]=e("span",{class:"detail-label"},"Rent",-1)),e("span",null,a(N(o.currentRent))+" p.a.",1)]),e("div",Gt,[s[41]||(s[41]=e("span",{class:"detail-label"},"Review",-1)),e("span",null,a(o.reviewType)+" "+a(o.reviewPercentage?`(${o.reviewPercentage}%)`:""),1)])])],2))),128)),u.value.length===0?(l(),i("div",jt," No leases recorded ")):P("",!0)])])):P("",!0),d.value==="ledger"?(l(),i("div",Ht,[e("div",Wt,[s[42]||(s[42]=e("h3",null,"Transaction Ledger",-1)),e("button",{class:"btn btn-secondary btn-sm",onClick:s[13]||(s[13]=o=>v.value=!v.value)},a(v.value?"Cancel":"+ Add Entry"),1)]),v.value?(l(),i("form",{key:0,class:"inline-form",onSubmit:U(Q,["prevent"])},[e("div",Jt,[$(e("input",{"onUpdate:modelValue":s[14]||(s[14]=o=>m.value.date=o),type:"date",required:""},null,512),[[R,m.value.date]]),$(e("select",{"onUpdate:modelValue":s[15]||(s[15]=o=>m.value.type=o),required:""},[...s[43]||(s[43]=[Y('<option value="">Type</option><option value="Rent_Gross">Rent (Gross)</option><option value="Outgoing_Recoverable">Outgoings Recoverable</option><option value="Council_Rates">Council Rates</option><option value="Water_Rates">Water Rates</option><option value="Insurance">Insurance</option><option value="Management_Fee">Management Fee</option><option value="Repairs_CapEx">Repairs/CapEx</option><option value="Other_Income">Other Income</option><option value="Other_Expense">Other Expense</option>',10)])],512),[[z,m.value.type]]),$(e("input",{"onUpdate:modelValue":s[16]||(s[16]=o=>m.value.amount=o),type:"number",placeholder:"Amount",required:""},null,512),[[R,m.value.amount,void 0,{number:!0}]]),e("label",Kt,[$(e("input",{type:"checkbox","onUpdate:modelValue":s[17]||(s[17]=o=>m.value.isIncome=o)},null,512),[[ee,m.value.isIncome]]),s[44]||(s[44]=B(" Income ",-1))]),e("button",{type:"submit",class:"btn btn-primary btn-sm",disabled:g.value},"Add",8,Zt)])],32)):P("",!0),e("div",Qt,[(l(!0),i(V,null,E(n.value,o=>(l(),i("div",{key:o.id,class:"ledger-item"},[e("div",Xt,a(q(o.date)),1),e("div",es,a(X(o.type)),1),e("div",{class:I(["ledger-amount",o.isIncome?"value-positive":"value-negative"])},a(o.isIncome?"+":"-")+a(N(o.amount)),3)]))),128)),n.value.length===0?(l(),i("div",ts," No ledger entries ")):P("",!0)])])):P("",!0)])],64)):P("",!0)])]))}},os={class:"property-hub animate-fade-in"},as={key:0,class:"page-loader-container"},ns={class:"hub-header"},ls={class:"header-actions"},rs={class:"stats-grid"},is={class:"stat-card stat-primary animate-fade-in-up stagger-1"},ds={class:"stat-content"},us={class:"stat-value value-large"},cs={class:"stat-card animate-fade-in-up stagger-2"},ps={class:"stat-content"},vs={class:"stat-detail text-muted"},ms={class:"stat-card animate-fade-in-up stagger-3"},ys={class:"stat-content"},gs={class:"stat-value"},fs={class:"stat-card animate-fade-in-up stagger-4"},hs={class:"stat-content"},bs={class:"stat-value"},ws={class:"stat-detail text-muted"},xs={class:"bento-grid"},ks={class:"bento-card bento-yield card animate-fade-in-up stagger-1"},$s={class:"bento-card bento-properties card animate-fade-in-up stagger-2"},_s={class:"card-header"},Cs={key:0,class:"empty-state"},Ps={class:"bento-card bento-vacancy card animate-fade-in-up stagger-3"},Is={class:"card-header"},As={key:0,class:"badge badge-warning"},Ds={class:"bento-card bento-cashflow card animate-fade-in-up stagger-4"},Fs={class:"modal property-modal"},Ss={class:"modal-header"},Rs={class:"form-group"},Vs={class:"form-row"},Ls={class:"form-group"},Es={class:"form-group"},Ts={class:"form-row"},Ns={class:"form-group"},Ms={class:"form-group"},Us={class:"form-group"},Ys={class:"form-group"},Bs={class:"modal-actions"},Os=["disabled"],qs={__name:"PropertyHubView",setup(x){const p=ae(),b=h(!0),c=h({totalValue:0,totalPurchasePrice:0,netYieldPercent:0,grossRentalIncome:0,totalExpenses:0,netIncome:0,totalProperties:0,activeLeases:0,expiringLeases:0,properties:[],vacancyHeatmap:[],cashflowForecast:[]}),S=h(null),y=h(!1),k=h(!1),u=h("cards"),n=h({address:"",buildingType:"",totalGFA:0,purchasePrice:0,purchaseDate:new Date().toISOString().split("T")[0],titleReference:"",description:""}),d=A(()=>c.value.totalValue-c.value.totalPurchasePrice),_=A(()=>{const g=c.value.netYieldPercent;return g>=6?"value-positive":g>=4?"value-warning":"value-negative"});function C(g){return new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(g||0)}function r(){u.value=u.value==="cards"?"list":"cards"}function v(g){S.value=g}async function F(){const g=p.currentPortfolioId;if(g)try{b.value=!0;const t=await M.get("/commercialproperty/dashboard",{params:{portfolioId:g}});c.value=t.data}catch(t){console.error("Failed to load property dashboard:",t)}finally{b.value=!1}}async function w(){const g=p.currentPortfolioId;if(!g){alert("No portfolio selected");return}try{k.value=!0,await M.post("/commercialproperty",{...n.value,portfolioId:g}),y.value=!1,n.value={address:"",buildingType:"",totalGFA:0,purchasePrice:0,purchaseDate:new Date().toISOString().split("T")[0],titleReference:"",description:""},await F()}catch(t){console.error("Failed to create property:",t),alert("Failed to create property. Please try again.")}finally{k.value=!1}}return W(()=>p.currentPortfolioId,g=>{g&&F()}),se(()=>{p.currentPortfolioId&&F()}),(g,t)=>{const D=G("router-link");return l(),i("div",os,[b.value?(l(),i("div",as,[L(ne,{size:"lg",text:"Loading Property Portfolio..."})])):(l(),i(V,{key:1},[e("section",ns,[t[15]||(t[15]=e("div",{class:"header-content"},[e("h1",{class:"hub-title"},"Property Portfolio"),e("p",{class:"hub-subtitle"},"Commercial real estate holdings overview")],-1)),e("div",ls,[L(D,{to:"/acquisitions",class:"btn btn-secondary"},{default:oe(()=>[...t[13]||(t[13]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1),B(" Acquisitions ",-1)])]),_:1}),e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=m=>y.value=!0)},[...t[14]||(t[14]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),B(" Add Property ",-1)])])])]),e("section",rs,[e("div",is,[t[17]||(t[17]=e("div",{class:"stat-icon"},[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e("polyline",{points:"9 22 9 12 15 12 15 22"})])],-1)),e("div",ds,[t[16]||(t[16]=e("span",{class:"stat-label"},"Total Portfolio Value",-1)),e("span",us,a(C(c.value.totalValue)),1),e("span",{class:I(["stat-detail",{"value-positive":d.value>=0,"value-negative":d.value<0}])},a(d.value>=0?"+":"")+a(C(d.value))+" from purchase ",3)])]),e("div",cs,[t[19]||(t[19]=e("div",{class:"stat-icon stat-icon-yield"},[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12 6 12 12 16 14"})])],-1)),e("div",ps,[t[18]||(t[18]=e("span",{class:"stat-label"},"Net Yield",-1)),e("span",{class:I(["stat-value",_.value])},a(c.value.netYieldPercent.toFixed(2))+"%",3),e("span",vs,a(C(c.value.netIncome))+" p.a.",1)])]),e("div",ms,[t[21]||(t[21]=Y('<div class="stat-icon stat-icon-leases" data-v-588c9cbc><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-588c9cbc><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-588c9cbc></path><polyline points="14 2 14 8 20 8" data-v-588c9cbc></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-588c9cbc></line><line x1="16" y1="17" x2="8" y2="17" data-v-588c9cbc></line></svg></div>',1)),e("div",ys,[t[20]||(t[20]=e("span",{class:"stat-label"},"Active Leases",-1)),e("span",gs,a(c.value.activeLeases),1),e("span",{class:I(["stat-detail",{"value-warning":c.value.expiringLeases>0}])},a(c.value.expiringLeases)+" expiring in 12mo ",3)])]),e("div",fs,[t[23]||(t[23]=Y('<div class="stat-icon stat-icon-properties" data-v-588c9cbc><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-588c9cbc><rect x="3" y="3" width="18" height="18" rx="2" ry="2" data-v-588c9cbc></rect><line x1="3" y1="9" x2="21" y2="9" data-v-588c9cbc></line><line x1="9" y1="21" x2="9" y2="9" data-v-588c9cbc></line></svg></div>',1)),e("div",hs,[t[22]||(t[22]=e("span",{class:"stat-label"},"Properties",-1)),e("span",bs,a(c.value.totalProperties),1),e("span",ws,a(C(c.value.grossRentalIncome))+" gross income ",1)])])]),e("section",xs,[e("div",ks,[t[24]||(t[24]=e("div",{class:"card-header"},[e("h3",null,"Net Yield Performance"),e("span",{class:"badge badge-info"},"Last 12 Months")],-1)),L(ye,{"yield-percent":c.value.netYieldPercent,"target-yield":6,"gross-income":c.value.grossRentalIncome,expenses:c.value.totalExpenses},null,8,["yield-percent","gross-income","expenses"])]),e("div",$s,[e("div",_s,[t[25]||(t[25]=e("h3",null,"Holdings",-1)),e("button",{class:"btn btn-ghost btn-sm",onClick:r},a(u.value==="cards"?"List":"Cards"),1)]),e("div",{class:I(["properties-container",u.value])},[(l(!0),i(V,null,E(c.value.properties,m=>(l(),H(He,{key:m.id,property:m,onClick:T=>v(m)},null,8,["property","onClick"]))),128)),c.value.properties.length===0?(l(),i("div",Cs,[t[26]||(t[26]=e("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e("polyline",{points:"9 22 9 12 15 12 15 22"})],-1)),t[27]||(t[27]=e("p",null,"No properties yet",-1)),e("button",{class:"btn btn-secondary btn-sm",onClick:t[1]||(t[1]=m=>y.value=!0)},"Add your first property")])):P("",!0)],2)]),e("div",Ps,[e("div",Is,[t[28]||(t[28]=e("h3",null,"Lease Expiry Timeline",-1)),c.value.expiringLeases>0?(l(),i("span",As,a(c.value.expiringLeases)+" at risk ",1)):P("",!0)]),L(he,{data:c.value.vacancyHeatmap},null,8,["data"])]),e("div",Ds,[t[29]||(t[29]=e("div",{class:"card-header"},[e("h3",null,"12-Month Cashflow Forecast")],-1)),L(Ye,{data:c.value.cashflowForecast},null,8,["data"])])])],64)),S.value?(l(),H(ss,{key:2,"property-id":S.value.id,onClose:t[2]||(t[2]=m=>S.value=null),onUpdated:F},null,8,["property-id"])):P("",!0),y.value?(l(),i("div",{key:3,class:"modal-backdrop",onClick:t[12]||(t[12]=U(m=>y.value=!1,["self"]))},[e("div",Fs,[e("div",Ss,[t[30]||(t[30]=e("h2",null,"Add Commercial Property",-1)),e("button",{class:"btn-close",onClick:t[3]||(t[3]=m=>y.value=!1)},"×")]),e("form",{onSubmit:U(w,["prevent"]),class:"modal-body"},[e("div",Rs,[t[31]||(t[31]=e("label",null,"Address *",-1)),$(e("input",{"onUpdate:modelValue":t[4]||(t[4]=m=>n.value.address=m),type:"text",required:"",placeholder:"123 Main Street, Sydney NSW 2000"},null,512),[[R,n.value.address]])]),e("div",Vs,[e("div",Ls,[t[33]||(t[33]=e("label",null,"Building Type *",-1)),$(e("select",{"onUpdate:modelValue":t[5]||(t[5]=m=>n.value.buildingType=m),required:""},[...t[32]||(t[32]=[Y('<option value="" data-v-588c9cbc>Select type</option><option value="Office" data-v-588c9cbc>Office</option><option value="Retail" data-v-588c9cbc>Retail</option><option value="Industrial" data-v-588c9cbc>Industrial</option><option value="Mixed" data-v-588c9cbc>Mixed Use</option>',5)])],512),[[z,n.value.buildingType]])]),e("div",Es,[t[34]||(t[34]=e("label",null,"Total GFA (m²)",-1)),$(e("input",{"onUpdate:modelValue":t[6]||(t[6]=m=>n.value.totalGFA=m),type:"number",min:"0",step:"0.01",placeholder:"1000"},null,512),[[R,n.value.totalGFA,void 0,{number:!0}]])])]),e("div",Ts,[e("div",Ns,[t[35]||(t[35]=e("label",null,"Purchase Price *",-1)),$(e("input",{"onUpdate:modelValue":t[7]||(t[7]=m=>n.value.purchasePrice=m),type:"number",min:"0",step:"0.01",required:"",placeholder:"1500000"},null,512),[[R,n.value.purchasePrice,void 0,{number:!0}]])]),e("div",Ms,[t[36]||(t[36]=e("label",null,"Purchase Date *",-1)),$(e("input",{"onUpdate:modelValue":t[8]||(t[8]=m=>n.value.purchaseDate=m),type:"date",required:""},null,512),[[R,n.value.purchaseDate]])])]),e("div",Us,[t[37]||(t[37]=e("label",null,"Title Reference",-1)),$(e("input",{"onUpdate:modelValue":t[9]||(t[9]=m=>n.value.titleReference=m),type:"text",placeholder:"Lot 1 DP 123456"},null,512),[[R,n.value.titleReference]])]),e("div",Ys,[t[38]||(t[38]=e("label",null,"Description",-1)),$(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=m=>n.value.description=m),rows:"2",placeholder:"Additional notes about the property"},null,512),[[R,n.value.description]])]),e("div",Bs,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[11]||(t[11]=m=>y.value=!1)},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:k.value},a(k.value?"Creating...":"Create Property"),9,Os)])],32)])])):P("",!0)])}}},Js=te(qs,[["__scopeId","data-v-588c9cbc"]]);export{Js as default};
