import{_ as L,r,k as u,i as P,c as l,o,a as t,x as C,y as F,F as p,q as f,d as k,t as n,p as i,e as O,J as R,n as $,B as x}from"./index-D2Wtd9Sa.js";import{f as v,a as Y,b as j}from"./formatters-DwG4QyEz.js";const q={class:"dividends-view animate-fade-in"},z={class:"header-row"},J={class:"portfolio-selector"},W=["value"],G={key:0,class:"loader-container"},K={class:"summary-grid"},Q={class:"summary-card card"},X={class:"value-large"},Z={class:"text-muted"},tt={class:"summary-card card"},et={class:"label-text"},st={class:"value-large value-positive"},at={class:"text-muted"},lt={class:"summary-card card"},ot={class:"value-large"},nt={key:0,class:"chart-section card"},it={class:"chart-container"},dt={class:"tabs"},rt={key:1,class:"table-section card"},ct={key:0,class:"data-table"},ut={class:"date-badge"},vt={class:"asset-cell"},mt={class:"asset-symbol"},yt={class:"asset-name"},ht={class:"text-right"},pt={class:"value-positive"},_t={key:0,class:"estimate-badge"},gt={key:1,class:"empty-state"},bt={key:2,class:"table-section card"},ft={class:"filter-row"},kt=["value"],xt={key:0,class:"data-table"},wt={class:"asset-cell"},Dt={class:"asset-symbol"},Ct={class:"asset-name"},Ft={class:"text-right value-positive"},$t={class:"text-right"},Yt={key:1,class:"empty-state"},Nt={__name:"DividendCalendarView",setup(St){const N=R,_=r(!0),m=r("upcoming"),g=r([]),d=r(null),y=r([]),c=r([]),h=r([]),b=r(new Date().getMonth()>5?new Date().getFullYear()+1:new Date().getFullYear()),S=u(()=>b.value),A=u(()=>{const e=new Date().getFullYear();return[e+1,e,e-1,e-2]}),V=u(()=>y.value.reduce((e,s)=>e+s.estimatedAmount,0)),U=u(()=>c.value.reduce((e,s)=>e+s.amount,0)),E=u(()=>c.value.reduce((e,s)=>e+s.frankingCredits,0)),T=u(()=>({chart:{type:"bar",toolbar:{show:!1},background:"transparent"},colors:["#10b981"],plotOptions:{bar:{borderRadius:4,columnWidth:"60%"}},dataLabels:{enabled:!1},xaxis:{categories:h.value.map(e=>`${e.monthName} ${e.year}`),labels:{style:{colors:"#94a3b8"}}},yaxis:{labels:{style:{colors:"#94a3b8"},formatter:e=>"$"+e.toLocaleString()}},grid:{borderColor:"rgba(255,255,255,0.1)"},tooltip:{theme:"dark",y:{formatter:e=>v(e)}}})),B=u(()=>[{name:"Dividends",data:h.value.map(e=>e.totalAmount)}]),H=async()=>{try{const e=await x.get("/portfolios");g.value=e.data,g.value.length>0&&(d.value=g.value[0].id)}catch(e){console.error("Failed to load portfolios",e)}},w=async()=>{if(d.value){_.value=!0;try{await Promise.all([I(),D(),M()])}finally{_.value=!1}}},I=async()=>{try{const e=await x.get(`/dividends/upcoming/${d.value}`);y.value=e.data}catch(e){console.error("Failed to load upcoming dividends",e),y.value=[]}},D=async()=>{try{const e=await x.get(`/dividends/history/${d.value}?fiscalYear=${b.value}`);c.value=e.data}catch(e){console.error("Failed to load dividend history",e),c.value=[]}},M=async()=>{try{const e=await x.get(`/dividends/summary/${d.value}`);h.value=e.data}catch(e){console.error("Failed to load monthly summary",e),h.value=[]}};return P(async()=>{await H(),d.value?await w():_.value=!1}),(e,s)=>(o(),l("div",q,[t("div",z,[s[4]||(s[4]=t("div",{class:"header-content"},[t("h1",null,"Dividend Calendar"),t("p",{class:"subtitle"},"Track upcoming dividend payments and historical income")],-1)),t("div",J,[C(t("select",{"onUpdate:modelValue":s[0]||(s[0]=a=>d.value=a),onChange:w},[(o(!0),l(p,null,f(g.value,a=>(o(),l("option",{key:a.id,value:a.id},n(a.name),9,W))),128))],544),[[F,d.value]])])]),_.value?(o(),l("div",G,[...s[5]||(s[5]=[t("div",{class:"spinner"},null,-1)])])):(o(),l(p,{key:1},[t("div",K,[t("div",Q,[s[6]||(s[6]=t("div",{class:"label-text"},"Upcoming (12 months)",-1)),t("div",X,n(i(v)(V.value)),1),t("div",Z,n(y.value.length)+" payments expected",1)]),t("div",tt,[t("div",et,"FY "+n(S.value)+" Received",1),t("div",st,n(i(v)(U.value)),1),t("div",at,n(c.value.length)+" payments",1)]),t("div",lt,[s[7]||(s[7]=t("div",{class:"label-text"},"Franking Credits",-1)),t("div",ot,n(i(v)(E.value)),1),s[8]||(s[8]=t("div",{class:"text-muted"},"Tax offset available",-1))])]),h.value.length>0?(o(),l("div",nt,[s[9]||(s[9]=t("h3",null,"Monthly Dividend Income",-1)),t("div",it,[O(i(N),{type:"bar",height:"250",options:T.value,series:B.value},null,8,["options","series"])])])):k("",!0),t("div",dt,[t("button",{class:$(["tab",{active:m.value==="upcoming"}]),onClick:s[1]||(s[1]=a=>m.value="upcoming")}," Upcoming ",2),t("button",{class:$(["tab",{active:m.value==="history"}]),onClick:s[2]||(s[2]=a=>m.value="history")}," History ",2)]),m.value==="upcoming"?(o(),l("div",rt,[y.value.length>0?(o(),l("table",ct,[s[10]||(s[10]=t("thead",null,[t("tr",null,[t("th",null,"Expected Date"),t("th",null,"Asset"),t("th",null,"Units Held"),t("th",{class:"text-right"},"Est. Amount")])],-1)),t("tbody",null,[(o(!0),l(p,null,f(y.value,a=>(o(),l("tr",{key:`${a.assetId}-${a.paymentDate}`},[t("td",null,[t("span",ut,n(i(Y)(a.paymentDate)),1)]),t("td",null,[t("div",vt,[t("span",mt,n(a.assetSymbol),1),t("span",yt,n(a.assetName),1)])]),t("td",null,n(i(j)(a.units)),1),t("td",ht,[t("span",pt,n(i(v)(a.estimatedAmount)),1),a.isEstimate?(o(),l("span",_t,"Est.")):k("",!0)])]))),128))])])):(o(),l("div",gt,[...s[11]||(s[11]=[t("p",null,"No upcoming dividends estimated. Add dividend-paying holdings to see projections.",-1)])]))])):k("",!0),m.value==="history"?(o(),l("div",bt,[t("div",ft,[s[12]||(s[12]=t("label",null,"Financial Year:",-1)),C(t("select",{"onUpdate:modelValue":s[3]||(s[3]=a=>b.value=a),onChange:D},[(o(!0),l(p,null,f(A.value,a=>(o(),l("option",{key:a,value:a},"FY "+n(a),9,kt))),128))],544),[[F,b.value]])]),c.value.length>0?(o(),l("table",xt,[s[13]||(s[13]=t("thead",null,[t("tr",null,[t("th",null,"Date"),t("th",null,"Asset"),t("th",{class:"text-right"},"Amount"),t("th",{class:"text-right"},"Franking Credits")])],-1)),t("tbody",null,[(o(!0),l(p,null,f(c.value,a=>(o(),l("tr",{key:`${a.date}-${a.assetSymbol}`},[t("td",null,n(i(Y)(a.date)),1),t("td",null,[t("div",wt,[t("span",Dt,n(a.assetSymbol),1),t("span",Ct,n(a.assetName),1)])]),t("td",Ft,n(i(v)(a.amount)),1),t("td",$t,n(i(v)(a.frankingCredits)),1)]))),128))])])):(o(),l("div",Yt,[...s[14]||(s[14]=[t("p",null,"No dividend history for this financial year.",-1)])]))])):k("",!0)],64))]))}},Ut=L(Nt,[["__scopeId","data-v-4cfcc8f4"]]);export{Ut as default};
