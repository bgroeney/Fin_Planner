import{_ as S,r as f,C as w,i as T,c as i,o as r,a as t,t as c,B as x,x as C,y as L,b as V,z as j,g as U,F as D,q as I,n as R,d as g,e as k}from"./index-D2Wtd9Sa.js";import{P as F}from"./PerformanceChart-BJtlk3wS.js";const B={class:"tax-summary"},A={class:"header-row"},z={class:"fy-selector"},E={class:"grid-cards"},O={class:"summary-card"},P={class:"value"},G={class:"summary-card"},M={class:"value"},Y={class:"subtext"},J={class:"summary-card highlight"},W={class:"value"},q={class:"summary-card info"},Q={class:"value"},H={__name:"TaxSummary",props:{portfolioId:String},setup(h){const p=h,n=f(new Date().getFullYear()+(new Date().getMonth()>5?1:0)),d=f({realizedGains:0,dividends:0,frankingCredits:0}),v=async()=>{if(p.portfolioId)try{const m=await x.get(`/reports/tax-summary/${p.portfolioId}`,{params:{fiscalYear:n.value}});d.value=m.data}catch(m){console.error(m)}};w(()=>p.portfolioId,v),w(n,v);const u=m=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD"}).format(m||0);return T(v),(m,l)=>(r(),i("div",B,[t("div",A,[t("h3",null,"Tax Summary (FY "+c(n.value)+")",1),t("div",z,[t("button",{onClick:l[0]||(l[0]=_=>n.value--),class:"btn-icon"},"←"),t("span",null,c(n.value-1)+" - "+c(n.value),1),t("button",{onClick:l[1]||(l[1]=_=>n.value++),class:"btn-icon"},"→")])]),t("div",E,[t("div",O,[l[2]||(l[2]=t("div",{class:"label"},"Realized Capital Gains",-1)),t("div",P,c(u(d.value.realizedGains)),1),l[3]||(l[3]=t("div",{class:"subtext"},"From asset sales",-1))]),t("div",G,[l[4]||(l[4]=t("div",{class:"label"},"Dividends",-1)),t("div",M,c(u(d.value.dividends)),1),t("div",Y,"+ "+c(u(d.value.frankingCredits))+" Franking Credits",1)]),t("div",J,[l[5]||(l[5]=t("div",{class:"label"},"Est. Tax Liability",-1)),t("div",W,c(u((d.value.realizedGains+d.value.dividends+d.value.frankingCredits)*.3)),1),l[6]||(l[6]=t("div",{class:"subtext"},"@ 30% Marginal Rate",-1))]),t("div",q,[l[7]||(l[7]=t("div",{class:"label"},"Gross Income",-1)),t("div",Q,c(u(d.value.realizedGains+d.value.dividends+d.value.frankingCredits)),1),l[8]||(l[8]=t("div",{class:"subtext"},"Total Taxable Income",-1))])])]))}},K=S(H,[["__scopeId","data-v-ad20570d"]]),X={class:"transaction-ledger card"},Z={class:"toolbar"},tt={class:"filters"},et={class:"data-table"},st={key:0},ot={class:"asset-cell"},at={class:"symbol"},nt={class:"name text-muted"},lt={class:"text-right"},it={class:"text-right font-mono"},rt={class:"small-text"},dt={key:1},ct={key:2},ut={__name:"TransactionLedger",props:{portfolioId:String},setup(h){const p=h,n=f([]),d=f(!0),v=f(""),u=f(""),m=async()=>{if(p.portfolioId){d.value=!0;try{const e={};v.value&&(e.type=v.value),u.value&&(e.search=u.value);const a=await x.get(`/reports/transactions/${p.portfolioId}`,{params:e});n.value=a.data}catch(e){console.error("Failed to load transactions",e)}finally{d.value=!1}}};w(()=>p.portfolioId,m),w([v,u],()=>{m()});const l=e=>new Date(e).toLocaleDateString("en-AU"),_=e=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD"}).format(e),y=e=>{switch(e){case"Buy":return"badge-info";case"Sell":return"badge-warning";case"Dividend":return"badge-success";default:return"badge-neutral"}},o=()=>{const e=["Date","Type","Symbol","Units","Amount","Narration"],a=n.value.map(b=>[new Date(b.effectiveDate).toLocaleDateString(),b.type,b.assetCode,b.units,b.amount,`"${b.narration}"`]),s=[e.join(","),...a.map(b=>b.join(","))].join(`
`),N=new Blob([s],{type:"text/csv;charset=utf-8;"}),$=document.createElement("a");$.href=URL.createObjectURL(N),$.download=`transactions_${p.portfolioId}.csv`,$.click()};return T(m),(e,a)=>(r(),i("div",X,[t("div",Z,[t("div",tt,[C(t("select",{"onUpdate:modelValue":a[0]||(a[0]=s=>v.value=s),class:"form-select"},[...a[2]||(a[2]=[V('<option value="" data-v-3f95e2e7>All Types</option><option value="Buy" data-v-3f95e2e7>Buy</option><option value="Sell" data-v-3f95e2e7>Sell</option><option value="Dividend" data-v-3f95e2e7>Dividend</option><option value="Deposit" data-v-3f95e2e7>Deposit</option><option value="Withdrawal" data-v-3f95e2e7>Withdrawal</option>',6)])],512),[[L,v.value]]),C(t("input",{"onUpdate:modelValue":a[1]||(a[1]=s=>u.value=s),type:"text",placeholder:"Search items...",class:"form-input"},null,512),[[j,u.value]])]),t("button",{class:"btn btn-secondary",onClick:o},[...a[3]||(a[3]=[t("span",{class:"icon"},"↓",-1),U(" Export CSV ",-1)])])]),t("table",et,[a[6]||(a[6]=t("thead",null,[t("tr",null,[t("th",null,"Date"),t("th",null,"Type"),t("th",null,"Asset"),t("th",{class:"text-right"},"Units"),t("th",{class:"text-right"},"Amount"),t("th",null,"Narration")])],-1)),!d.value&&n.value.length>0?(r(),i("tbody",st,[(r(!0),i(D,null,I(n.value,s=>(r(),i("tr",{key:s.id},[t("td",null,c(l(s.effectiveDate)),1),t("td",null,[t("span",{class:R(["badge",y(s.type)])},c(s.type),3)]),t("td",null,[t("div",ot,[t("span",at,c(s.assetCode),1),t("span",nt,c(s.assetName),1)])]),t("td",lt,c(s.units!==0?s.units.toLocaleString():"-"),1),t("td",it,c(_(s.amount)),1),t("td",rt,c(s.narration),1)]))),128))])):d.value?(r(),i("tbody",dt,[...a[4]||(a[4]=[t("tr",null,[t("td",{colspan:"6",class:"text-center"},"Loading...")],-1)])])):(r(),i("tbody",ct,[...a[5]||(a[5]=[t("tr",null,[t("td",{colspan:"6",class:"text-center text-muted"},"No transactions found")],-1)])]))])]))}},vt=S(ut,[["__scopeId","data-v-3f95e2e7"]]),pt={class:"reports-view animate-fade-in content-container"},mt={class:"page-header mb-lg"},ft={class:"controls"},yt={class:"select-wrapper"},bt=["value"],_t={key:0,class:"export-dropdown"},gt={key:0,class:"dropdown-menu"},ht={key:0},wt={class:"tabs mb-lg"},xt=["onClick"],$t={class:"tab-content"},kt={key:0,class:"animate-fade-in"},Ct={key:1,class:"animate-fade-in"},Dt={key:2,class:"animate-fade-in"},It={key:1,class:"loading-state card"},St={key:0,class:"spinner"},Tt={key:1,class:"text-muted"},Lt={__name:"ReportsView",setup(h){const p=f([]),n=f(null),d=f(!0),v=f("performance"),u=f(!1),m=[{id:"performance",label:"Performance"},{id:"tax",label:"Tax Center"},{id:"transactions",label:"Ledger"}],l=async()=>{try{const y=await x.get("/portfolios");p.value=y.data,p.value.length>0&&(n.value=p.value[0].id)}catch(y){console.error("Failed to load portfolios",y)}finally{d.value=!1}},_=async y=>{u.value=!1;try{const o=await x.get(`/reports/export/${n.value}?format=${y}`,{responseType:y==="csv"?"blob":"json"});if(y==="csv"){const e=new Blob([o.data],{type:"text/csv"}),a=window.URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download=`portfolio_export_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(a),s.remove()}else{const e=new Blob([JSON.stringify(o.data,null,2)],{type:"application/json"}),a=window.URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download=`portfolio_export_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(a),s.remove()}}catch(o){console.error("Failed to export data",o),alert("Failed to export data. Please try again.")}};return T(l),(y,o)=>(r(),i("div",pt,[t("div",mt,[o[5]||(o[5]=t("div",null,[t("h1",null,"Reports & Analysis"),t("p",{class:"text-muted"},"Track performance, tax liabilities, and transaction history.")],-1)),t("div",ft,[t("div",yt,[p.value.length>0?C((r(),i("select",{key:0,"onUpdate:modelValue":o[0]||(o[0]=e=>n.value=e),class:"portfolio-select"},[(r(!0),i(D,null,I(p.value,e=>(r(),i("option",{key:e.id,value:e.id},c(e.name),9,bt))),128))],512)),[[L,n.value]]):g("",!0)]),n.value?(r(),i("div",_t,[t("button",{class:"btn btn-secondary",onClick:o[1]||(o[1]=e=>u.value=!u.value)},[...o[4]||(o[4]=[U(" Export Data ",-1),t("span",{class:"dropdown-arrow"},"▾",-1)])]),u.value?(r(),i("div",gt,[t("button",{onClick:o[2]||(o[2]=e=>_("csv"))},"Download CSV"),t("button",{onClick:o[3]||(o[3]=e=>_("json"))},"Download JSON")])):g("",!0)])):g("",!0)])]),n.value?(r(),i("div",ht,[t("div",wt,[(r(),i(D,null,I(m,e=>t("button",{key:e.id,class:R(["tab-btn",{active:v.value===e.id}]),onClick:a=>v.value=e.id},c(e.label),11,xt)),64))]),t("div",$t,[v.value==="performance"?(r(),i("div",kt,[o[6]||(o[6]=t("div",{class:"section-header mb-md"},[t("h2",null,"Portfolio Performance"),t("p",{class:"text-muted"},"Visualizing portfolio value and growth over time versus invested capital.")],-1)),k(F,{portfolioId:n.value},null,8,["portfolioId"])])):g("",!0),v.value==="tax"?(r(),i("div",Ct,[o[7]||(o[7]=t("div",{class:"section-header mb-md"},[t("h2",null,"Tax Impact"),t("p",{class:"text-muted"},"Estimated tax liabilities, realized gains, and franking credits for the financial year.")],-1)),k(K,{portfolioId:n.value},null,8,["portfolioId"])])):g("",!0),v.value==="transactions"?(r(),i("div",Dt,[o[8]||(o[8]=t("div",{class:"section-header mb-md"},[t("h2",null,"Transaction Ledger"),t("p",{class:"text-muted"},"Complete history of all buy, sell, and income events.")],-1)),k(vt,{portfolioId:n.value},null,8,["portfolioId"])])):g("",!0)])])):(r(),i("div",It,[d.value?(r(),i("div",St)):(r(),i("p",Tt,"No portfolios found. Please create one to view reports."))]))]))}},Nt=S(Lt,[["__scopeId","data-v-73870ae7"]]);export{Nt as default};
