import{_ as W,r as u,i as X,c as l,o as n,a as t,v as P,x as r,y as R,F as C,q as A,d as k,g as w,e as Y,w as Z,f as tt,m as h,z as p,A as I,t as a,G as $,B as y,h as et,n as st}from"./index-D_ssXn_P.js";const ot={class:"entities-view animate-fade-in"},nt={class:"header-row"},lt={class:"portfolio-selector"},at=["value"],it={key:0,class:"loader-container"},rt={class:"entity-grid"},ut={class:"entity-section"},dt={key:0,class:"empty-card card"},vt={key:1,class:"entity-cards"},pt=["onClick"],mt={class:"entity-avatar person-avatar"},ct={class:"entity-info"},yt={class:"entity-meta"},ft={key:0},bt={class:"entity-section"},gt={key:0,class:"empty-card card"},kt={key:1,class:"entity-cards"},wt=["onClick"],ht={class:"entity-avatar trust-avatar"},xt={class:"entity-info"},Ct={class:"entity-meta"},Nt={class:"trust-type"},Tt={class:"entity-section"},Bt={key:0,class:"empty-card card"},Mt={key:1,class:"entity-cards"},At=["onClick"],_t={class:"entity-avatar company-avatar"},Vt={class:"entity-info"},Ut={class:"entity-meta"},Ft={class:"company-rate"},Pt={key:0,class:"loan-warning"},Rt={key:0,class:"optimization-cta card"},$t={class:"modal-card"},Dt={class:"modal-header"},It={class:"form-group"},Et={class:"form-group"},St={class:"form-group"},Ht={class:"form-group"},qt={class:"checkbox-label"},zt={class:"modal-actions"},Ot=["disabled"],jt={class:"modal-card"},Lt={class:"modal-header"},Gt={class:"form-group"},Jt={class:"form-group"},Kt={class:"form-group"},Qt={class:"form-group"},Wt={class:"modal-actions"},Xt=["disabled"],Yt={class:"modal-card"},Zt={class:"modal-header"},te={class:"form-group"},ee={class:"form-group"},se={class:"form-group"},oe={class:"form-group"},ne={class:"checkbox-label"},le={class:"form-row"},ae={class:"form-group"},ie={class:"form-group"},re={class:"form-group"},ue={class:"modal-actions"},de=["disabled"],ve={__name:"EntitiesView",setup(pe){const _=et(),N=u(!0),d=u(!1),T=u([]),v=u(null),B=u([]),M=u([]),V=u([]),f=u(!1),b=u(!1),g=u(!1),m=u({fullName:"",dateOfBirth:"",marginalTaxRate:.325,hasPrivateHealthInsurance:!1}),c=u({trustName:"",abn:"",trusteeName:"",trustType:"Discretionary"}),i=u({companyName:"",abn:"",acn:"",isBaseRateEntity:!0,retainedProfits:0,frankingAccountBalance:0,incorporationDate:""}),E=o=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD"}).format(o||0),U=o=>{if(!o)return"?";const e=o.split(" ");return e.length>=2?e[0][0]+e[1][0]:o.substring(0,2).toUpperCase()},S=o=>o<=.19?"tax-low":o<=.325?"tax-medium":"tax-high",H=async()=>{try{const o=await y.get("/portfolios");T.value=o.data,T.value.length>0&&(v.value=T.value[0].id)}catch(o){console.error("Failed to load portfolios",o)}},x=async()=>{if(v.value){N.value=!0;try{const[o,e,F]=await Promise.all([y.get(`/persons?portfolioId=${v.value}`),y.get(`/trusts?portfolioId=${v.value}`),y.get(`/companies?portfolioId=${v.value}`)]);B.value=o.data,M.value=e.data,V.value=F.data}catch(o){console.error("Failed to load entities",o)}finally{N.value=!1}}},q=()=>{m.value={fullName:"",dateOfBirth:"",marginalTaxRate:.325,hasPrivateHealthInsurance:!1},f.value=!0},z=()=>{c.value={trustName:"",abn:"",trusteeName:"",trustType:"Discretionary"},b.value=!0},O=()=>{i.value={companyName:"",abn:"",acn:"",isBaseRateEntity:!0,retainedProfits:0,frankingAccountBalance:0,incorporationDate:""},g.value=!0},j=async()=>{d.value=!0;try{await y.post("/persons",{portfolioId:v.value,...m.value}),f.value=!1,await x()}catch(o){console.error("Failed to create person",o),alert("Failed to create person")}finally{d.value=!1}},L=async()=>{d.value=!0;try{await y.post("/trusts",{portfolioId:v.value,...c.value}),b.value=!1,await x()}catch(o){console.error("Failed to create trust",o),alert("Failed to create trust")}finally{d.value=!1}},G=async()=>{d.value=!0;try{await y.post("/companies",{portfolioId:v.value,...i.value}),g.value=!1,await x()}catch(o){console.error("Failed to create company",o),alert("Failed to create company")}finally{d.value=!1}},J=o=>{_.push(`/entities/person/${o.id}`)},K=o=>{_.push(`/entities/trust/${o.id}`)},Q=o=>{_.push(`/entities/company/${o.id}`)};return X(async()=>{await H(),v.value?await x():N.value=!1}),(o,e)=>{const F=tt("router-link");return n(),l("div",ot,[t("div",nt,[e[25]||(e[25]=t("div",{class:"header-content"},[t("h1",null,"Entity Structure"),t("p",{class:"subtitle"},"Manage family members, trusts, and companies for tax planning")],-1)),t("div",lt,[r(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),onChange:x},[(n(!0),l(C,null,A(T.value,s=>(n(),l("option",{key:s.id,value:s.id},a(s.name),9,at))),128))],544),[[R,v.value]])])]),N.value?(n(),l("div",it,[...e[26]||(e[26]=[t("div",{class:"spinner"},null,-1)])])):(n(),l(C,{key:1},[t("div",rt,[t("div",ut,[t("div",{class:"section-header"},[e[27]||(e[27]=t("h2",null,[t("svg",{class:"section-icon",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),t("circle",{cx:"12",cy:"7",r:"4"})]),w(" Family Members ")],-1)),t("button",{class:"btn btn-primary btn-sm",onClick:q}," + Add Person ")]),B.value.length===0?(n(),l("div",dt,[...e[28]||(e[28]=[t("p",null,"No family members added yet.",-1)])])):(n(),l("div",vt,[(n(!0),l(C,null,A(B.value,s=>(n(),l("div",{key:s.id,class:"entity-card card",onClick:D=>J(s)},[t("div",mt,a(U(s.fullName)),1),t("div",ct,[t("h3",null,a(s.fullName),1),t("div",yt,[t("span",{class:st(["tax-rate",S(s.marginalTaxRate)])},a((s.marginalTaxRate*100).toFixed(0))+"% marginal ",3),s.superAccounts?.length?(n(),l("span",ft,a(s.superAccounts.length)+" super account(s) ",1)):k("",!0)])]),e[29]||(e[29]=t("svg",{class:"entity-arrow",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"9 18 15 12 9 6"})],-1))],8,pt))),128))]))]),t("div",bt,[t("div",{class:"section-header"},[e[30]||(e[30]=t("h2",null,[t("svg",{class:"section-icon",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M3 21h18M3 10h18M5 6l7-3 7 3M4 10v11M20 10v11M8 14v3M12 14v3M16 14v3"})]),w(" Trusts ")],-1)),t("button",{class:"btn btn-primary btn-sm",onClick:z}," + Add Trust ")]),M.value.length===0?(n(),l("div",gt,[...e[31]||(e[31]=[t("p",null,"No trusts added yet.",-1)])])):(n(),l("div",kt,[(n(!0),l(C,null,A(M.value,s=>(n(),l("div",{key:s.id,class:"entity-card card",onClick:D=>K(s)},[t("div",ht,a(U(s.trustName)),1),t("div",xt,[t("h3",null,a(s.trustName),1),t("div",Ct,[t("span",Nt,a(s.trustType),1),t("span",null,a(s.beneficiaries?.length||0)+" beneficiaries",1)])]),e[32]||(e[32]=t("svg",{class:"entity-arrow",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"9 18 15 12 9 6"})],-1))],8,wt))),128))]))]),t("div",Tt,[t("div",{class:"section-header"},[e[33]||(e[33]=t("h2",null,[t("svg",{class:"section-icon",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",ry:"2"}),t("path",{d:"M9 22V6h6v16"}),t("path",{d:"M8 6h.01M16 6h.01M8 10h.01M16 10h.01M8 14h.01M16 14h.01M8 18h.01M16 18h.01"})]),w(" Companies ")],-1)),t("button",{class:"btn btn-primary btn-sm",onClick:O}," + Add Company ")]),V.value.length===0?(n(),l("div",Bt,[...e[34]||(e[34]=[t("p",null,"No companies added yet.",-1)])])):(n(),l("div",Mt,[(n(!0),l(C,null,A(V.value,s=>(n(),l("div",{key:s.id,class:"entity-card card",onClick:D=>Q(s)},[t("div",_t,a(U(s.companyName)),1),t("div",Vt,[t("h3",null,a(s.companyName),1),t("div",Ut,[t("span",Ft,a((s.taxRate*100).toFixed(0))+"% tax rate",1),t("span",null,"Franking: "+a(E(s.frankingAccountBalance)),1)]),s.division7ALoans?.length?(n(),l("div",Pt," âš ï¸ "+a(s.division7ALoans.length)+" Div 7A loan(s) ",1)):k("",!0)]),e[35]||(e[35]=t("svg",{class:"entity-arrow",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("polyline",{points:"9 18 15 12 9 6"})],-1))],8,At))),128))]))])]),M.value.length>0&&B.value.length>0?(n(),l("div",Rt,[e[37]||(e[37]=t("div",{class:"cta-content"},[t("h3",null,"ðŸŽ¯ Optimize Trust Distributions"),t("p",null,"Use our tax optimization engine to distribute trust income efficiently across family members.")],-1)),Y(F,{to:"/tax-optimization",class:"btn btn-accent"},{default:Z(()=>[...e[36]||(e[36]=[w(" Open Tax Optimizer ",-1)])]),_:1})])):k("",!0)],64)),(n(),P($,{to:"body"},[f.value?(n(),l("div",{key:0,class:"modal-overlay",onClick:e[7]||(e[7]=h(s=>f.value=!1,["self"]))},[t("div",$t,[t("div",Dt,[e[38]||(e[38]=t("h2",null,"Add Family Member",-1)),t("button",{class:"btn-close",onClick:e[1]||(e[1]=s=>f.value=!1)},"Ã—")]),t("form",{onSubmit:h(j,["prevent"]),class:"modal-form"},[t("div",It,[e[39]||(e[39]=t("label",null,"Full Name",-1)),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>m.value.fullName=s),type:"text",required:""},null,512),[[p,m.value.fullName]])]),t("div",Et,[e[40]||(e[40]=t("label",null,"Date of Birth",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>m.value.dateOfBirth=s),type:"date",required:""},null,512),[[p,m.value.dateOfBirth]])]),t("div",St,[e[42]||(e[42]=t("label",null,"Marginal Tax Rate",-1)),r(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>m.value.marginalTaxRate=s)},[...e[41]||(e[41]=[t("option",{value:0},"0% (Tax-free threshold)",-1),t("option",{value:.19},"19%",-1),t("option",{value:.325},"32.5%",-1),t("option",{value:.37},"37%",-1),t("option",{value:.45},"45%",-1)])],512),[[R,m.value.marginalTaxRate]])]),t("div",Ht,[t("label",qt,[r(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>m.value.hasPrivateHealthInsurance=s)},null,512),[[I,m.value.hasPrivateHealthInsurance]]),e[43]||(e[43]=w(" Has private health insurance ",-1))])]),t("div",zt,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=s=>f.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:d.value},a(d.value?"Saving...":"Add Person"),9,Ot)])],32)])])):k("",!0)])),(n(),P($,{to:"body"},[b.value?(n(),l("div",{key:0,class:"modal-overlay",onClick:e[14]||(e[14]=h(s=>b.value=!1,["self"]))},[t("div",jt,[t("div",Lt,[e[44]||(e[44]=t("h2",null,"Add Trust",-1)),t("button",{class:"btn-close",onClick:e[8]||(e[8]=s=>b.value=!1)},"Ã—")]),t("form",{onSubmit:h(L,["prevent"]),class:"modal-form"},[t("div",Gt,[e[45]||(e[45]=t("label",null,"Trust Name",-1)),r(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>c.value.trustName=s),type:"text",required:""},null,512),[[p,c.value.trustName]])]),t("div",Jt,[e[46]||(e[46]=t("label",null,"ABN (optional)",-1)),r(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>c.value.abn=s),type:"text"},null,512),[[p,c.value.abn]])]),t("div",Kt,[e[47]||(e[47]=t("label",null,"Trustee Name",-1)),r(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>c.value.trusteeName=s),type:"text",required:""},null,512),[[p,c.value.trusteeName]])]),t("div",Qt,[e[49]||(e[49]=t("label",null,"Trust Type",-1)),r(t("select",{"onUpdate:modelValue":e[12]||(e[12]=s=>c.value.trustType=s)},[...e[48]||(e[48]=[t("option",{value:"Discretionary"},"Discretionary (Family Trust)",-1),t("option",{value:"Unit"},"Unit Trust",-1),t("option",{value:"Hybrid"},"Hybrid Trust",-1)])],512),[[R,c.value.trustType]])]),t("div",Wt,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[13]||(e[13]=s=>b.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:d.value},a(d.value?"Saving...":"Add Trust"),9,Xt)])],32)])])):k("",!0)])),(n(),P($,{to:"body"},[g.value?(n(),l("div",{key:0,class:"modal-overlay",onClick:e[24]||(e[24]=h(s=>g.value=!1,["self"]))},[t("div",Yt,[t("div",Zt,[e[50]||(e[50]=t("h2",null,"Add Company",-1)),t("button",{class:"btn-close",onClick:e[15]||(e[15]=s=>g.value=!1)},"Ã—")]),t("form",{onSubmit:h(G,["prevent"]),class:"modal-form"},[t("div",te,[e[51]||(e[51]=t("label",null,"Company Name",-1)),r(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>i.value.companyName=s),type:"text",required:""},null,512),[[p,i.value.companyName]])]),t("div",ee,[e[52]||(e[52]=t("label",null,"ABN (optional)",-1)),r(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>i.value.abn=s),type:"text"},null,512),[[p,i.value.abn]])]),t("div",se,[e[53]||(e[53]=t("label",null,"ACN (optional)",-1)),r(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>i.value.acn=s),type:"text"},null,512),[[p,i.value.acn]])]),t("div",oe,[t("label",ne,[r(t("input",{type:"checkbox","onUpdate:modelValue":e[19]||(e[19]=s=>i.value.isBaseRateEntity=s)},null,512),[[I,i.value.isBaseRateEntity]]),e[54]||(e[54]=w(" Base rate entity (25% tax rate) ",-1))])]),t("div",le,[t("div",ae,[e[55]||(e[55]=t("label",null,"Retained Profits",-1)),r(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>i.value.retainedProfits=s),type:"number",step:"0.01"},null,512),[[p,i.value.retainedProfits,void 0,{number:!0}]])]),t("div",ie,[e[56]||(e[56]=t("label",null,"Franking Balance",-1)),r(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>i.value.frankingAccountBalance=s),type:"number",step:"0.01"},null,512),[[p,i.value.frankingAccountBalance,void 0,{number:!0}]])])]),t("div",re,[e[57]||(e[57]=t("label",null,"Incorporation Date",-1)),r(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>i.value.incorporationDate=s),type:"date",required:""},null,512),[[p,i.value.incorporationDate]])]),t("div",ue,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[23]||(e[23]=s=>g.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:d.value},a(d.value?"Saving...":"Add Company"),9,de)])],32)])])):k("",!0)]))])}}},ce=W(ve,[["__scopeId","data-v-6960ea01"]]);export{ce as default};
