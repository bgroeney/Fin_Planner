import{_ as I,r as c,k as Y,i as B,c as l,o as n,a as t,d as u,x as k,y as C,F as _,q as h,t as i,b as N,v as V,w as A,f as G,B as b,n as w,g}from"./index-D2Wtd9Sa.js";const U={class:"tax-optimizer-view animate-fade-in"},M={class:"controls-row card"},R={class:"control-group"},S=["value"],E={class:"control-group"},$=["value"],j=["disabled"],q={key:0,class:"loader-container"},L={key:1,class:"optimization-results"},P={class:"summary-grid"},H={class:"summary-card card"},J={class:"value-large"},K={class:"summary-card card"},Q={class:"value-large"},W={class:"text-muted"},X={class:"summary-card card highlight-success"},Z={class:"value-large value-positive"},tt={class:"recommendations-section card"},st={class:"section-description"},et={key:0,class:"data-table"},at={class:"beneficiary-cell"},it={class:"beneficiary-name"},nt={class:"text-right"},lt={key:0,class:"text-muted text-small"},ot={class:"text-right"},rt={class:"text-right"},dt={key:0},ut={key:1},ct={key:2},vt={class:"text-right font-semibold"},mt={class:"text-right"},pt={class:"rate-change"},yt={class:"rate-before"},_t={class:"rate-after"},ht={key:0,class:"text-small"},bt={key:1,class:"empty-state"},gt={key:0,class:"action-row"},xt=["disabled"],ft={key:2,class:"empty-state card"},kt={__name:"TaxOptimizerView",setup(Ct){const v=c(!1),m=c(!1),y=c([]),d=c(null),p=c(new Date().getMonth()>5?new Date().getFullYear()+1:new Date().getFullYear()),o=c(null),D=Y(()=>{const a=new Date().getFullYear();return[a+1,a,a-1]}),r=a=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",maximumFractionDigits:0}).format(a||0),x=a=>((a||0)*100).toFixed(1)+"%",T=async()=>{try{const a=await b.get("/trusts");y.value=a.data}catch(a){console.error("Failed to load trusts",a)}},z=async()=>{if(d.value){v.value=!0,o.value=null;try{const a=await b.get(`/trusts/${d.value}/optimize-distribution?fiscalYear=${p.value}`);o.value=a.data}catch(a){console.error("Failed to run optimization",a),alert("Failed to run optimization. Make sure you have trust income recorded for this fiscal year.")}finally{v.value=!1}}},F=async()=>{if(!(!d.value||!o.value)){m.value=!0;try{const a=await b.post(`/trusts/${d.value}/apply-optimization?fiscalYear=${p.value}`);alert(a.data.message||"Distributions created successfully")}catch(a){console.error("Failed to apply optimization",a),alert("Failed to apply optimization")}finally{m.value=!1}}},f=()=>{o.value=null};return B(T),(a,s)=>{const O=G("router-link");return n(),l("div",U,[s[17]||(s[17]=t("div",{class:"header-row"},[t("div",{class:"header-content"},[t("h1",null,"Tax Distribution Optimizer"),t("p",{class:"subtitle"},"Optimize trust income distribution to minimize family tax liability")])],-1)),t("div",M,[t("div",R,[s[3]||(s[3]=t("label",null,"Trust",-1)),k(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>d.value=e),onChange:f},[s[2]||(s[2]=t("option",{value:null,disabled:""},"Select a trust...",-1)),(n(!0),l(_,null,h(y.value,e=>(n(),l("option",{key:e.id,value:e.id},i(e.trustName),9,S))),128))],544),[[C,d.value]])]),t("div",E,[s[4]||(s[4]=t("label",null,"Financial Year",-1)),k(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>p.value=e)},[(n(!0),l(_,null,h(D.value,e=>(n(),l("option",{key:e,value:e},"FY "+i(e),9,$))),128))],512),[[C,p.value]])]),t("button",{class:"btn btn-primary",disabled:!d.value||v.value,onClick:z},i(v.value?"Optimizing...":"Optimize Distribution"),9,j)]),v.value?(n(),l("div",q,[...s[5]||(s[5]=[t("div",{class:"spinner"},null,-1)])])):o.value?(n(),l("div",L,[t("div",P,[t("div",H,[s[6]||(s[6]=t("div",{class:"label-text"},"Total Distributable Income",-1)),t("div",J,i(r(o.value.totalDistributableIncome)),1)]),t("div",K,[s[7]||(s[7]=t("div",{class:"label-text"},"Franking Credits Available",-1)),t("div",Q,i(r(o.value.totalFrankingCredits)),1),t("div",W,"Used: "+i(r(o.value.totalFrankingCreditsUsed)),1)]),t("div",X,[s[8]||(s[8]=t("div",{class:"label-text"},"Estimated Total Tax",-1)),t("div",Z,i(r(o.value.totalEstimatedTax)),1),s[9]||(s[9]=t("div",{class:"text-muted"},"After franking credit offsets",-1))])]),t("div",tt,[s[14]||(s[14]=t("h2",null,"Recommended Distributions",-1)),t("p",st,i(o.value.message),1),o.value.recommendations?.length>0?(n(),l("table",et,[s[12]||(s[12]=t("thead",null,[t("tr",null,[t("th",null,"Beneficiary"),t("th",null,"Type"),t("th",{class:"text-right"},"Franked Dividends"),t("th",{class:"text-right"},"Other Income"),t("th",{class:"text-right"},"Capital Gains"),t("th",{class:"text-right"},"Total"),t("th",{class:"text-right"},"Tax Rate"),t("th",{class:"text-right"},"Est. Tax")])],-1)),t("tbody",null,[(n(!0),l(_,null,h(o.value.recommendations,e=>(n(),l("tr",{key:e.beneficiaryId},[t("td",null,[t("div",at,[t("span",it,i(e.beneficiaryName),1)])]),t("td",null,[t("span",{class:w(["type-badge",e.isCompany?"type-company":"type-person"])},i(e.isCompany?"Company":"Individual"),3)]),t("td",nt,[t("div",null,i(r(e.frankedDividends)),1),e.frankingCredits>0?(n(),l("div",lt," + "+i(r(e.frankingCredits))+" FC ",1)):u("",!0)]),t("td",ot,i(r(e.unfrankedIncome)),1),t("td",rt,[e.discountCapitalGains>0?(n(),l("div",dt,[g(i(r(e.discountCapitalGains))+" ",1),s[10]||(s[10]=t("span",{class:"text-muted text-small"},"(50% disc.)",-1))])):u("",!0),e.nonDiscountCapitalGains>0?(n(),l("div",ut,i(r(e.nonDiscountCapitalGains)),1)):u("",!0),e.discountCapitalGains===0&&e.nonDiscountCapitalGains===0?(n(),l("span",ct,"-")):u("",!0)]),t("td",vt,i(r(e.totalDistribution)),1),t("td",mt,[t("div",pt,[t("span",yt,i(x(e.marginalTaxRateBefore)),1),s[11]||(s[11]=t("span",{class:"rate-arrow"},"â†’",-1)),t("span",_t,i(x(e.marginalTaxRateAfter)),1)])]),t("td",{class:w(["text-right",e.estimatedTaxOnDistribution<0?"value-positive":""])},[g(i(r(e.estimatedTaxOnDistribution))+" ",1),e.estimatedTaxOnDistribution<0?(n(),l("span",ht,"(refund)")):u("",!0)],2)]))),128))])])):(n(),l("div",bt,[...s[13]||(s[13]=[t("p",null,"No distribution recommendations available. Make sure you have beneficiaries added to this trust.",-1)])]))]),o.value.recommendations?.length>0?(n(),l("div",gt,[t("button",{class:"btn btn-secondary",onClick:f}," Reset "),t("button",{class:"btn btn-primary",onClick:F,disabled:m.value},i(m.value?"Applying...":"Apply as Draft Distributions"),9,xt)])):u("",!0)])):d.value?u("",!0):(n(),l("div",ft,[s[16]||(s[16]=N('<div class="empty-icon" data-v-59943309><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-59943309><circle cx="12" cy="12" r="10" data-v-59943309></circle><circle cx="12" cy="12" r="6" data-v-59943309></circle><circle cx="12" cy="12" r="2" data-v-59943309></circle></svg></div><h3 data-v-59943309>Select a Trust to Optimize</h3><p data-v-59943309>Choose a trust from the dropdown above to run the tax distribution optimizer.</p>',3)),y.value.length===0?(n(),V(O,{key:0,to:"/entities",class:"btn btn-secondary"},{default:A(()=>[...s[15]||(s[15]=[g(" Create a Trust First ",-1)])]),_:1})):u("",!0)]))])}}},Dt=I(kt,[["__scopeId","data-v-59943309"]]);export{Dt as default};
