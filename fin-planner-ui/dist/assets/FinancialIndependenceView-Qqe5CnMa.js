import{_ as F,o as i,c as r,b as B,x as D,a as t,e as h,t as n,p as c,v as u,n as w,i as E,f as C,d as G,F as W,l as K,D as Y,H as q,g as l,s as I,z as _,r as J}from"./index-oVbs5Hxd.js";import{usePortfolioStore as Q}from"./portfolio-CjZnfIUI.js";import{b as X}from"./formatters-DwG4QyEz.js";const Z={},tt={class:"money-flow card p-6"};function et(z,p){return i(),r("div",tt,[...p[0]||(p[0]=[B('<h3 class="font-bold mb-6 flex items-center gap-2" data-v-68fa0602><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-68fa0602><path d="M22 12h-4l-3 9L9 3l-3 9H2" data-v-68fa0602></path></svg> Annual Cashflow (Sankey) </h3><div class="sankey-container" data-v-68fa0602><svg width="100%" height="300" viewBox="0 0 600 300" data-v-68fa0602><g class="nodes" data-v-68fa0602><rect x="50" y="50" width="100" height="40" rx="4" fill="var(--color-success)" opacity="0.8" data-v-68fa0602></rect><text x="100" y="75" text-anchor="middle" fill="white" font-size="12" font-weight="bold" data-v-68fa0602>Salary</text><rect x="50" y="110" width="100" height="40" rx="4" fill="var(--color-success)" opacity="0.6" data-v-68fa0602></rect><text x="100" y="135" text-anchor="middle" fill="white" font-size="12" font-weight="bold" data-v-68fa0602>Dividends</text><rect x="50" y="170" width="100" height="40" rx="4" fill="var(--color-success)" opacity="0.4" data-v-68fa0602></rect><text x="100" y="195" text-anchor="middle" fill="white" font-size="12" font-weight="bold" data-v-68fa0602>Rental</text></g><rect x="250" y="100" width="100" height="100" rx="8" fill="var(--color-accent)" opacity="0.2" stroke="var(--color-accent)" stroke-width="2" data-v-68fa0602></rect><text x="300" y="150" text-anchor="middle" fill="var(--color-text-primary)" font-size="14" font-weight="bold" data-v-68fa0602>Total Income</text><g class="nodes" data-v-68fa0602><rect x="450" y="50" width="100" height="40" rx="4" fill="var(--color-danger)" opacity="0.8" data-v-68fa0602></rect><text x="500" y="75" text-anchor="middle" fill="white" font-size="12" font-weight="bold" data-v-68fa0602>Expenses</text><rect x="450" y="110" width="100" height="40" rx="4" fill="var(--color-danger)" opacity="0.6" data-v-68fa0602></rect><text x="500" y="135" text-anchor="middle" fill="white" font-size="12" font-weight="bold" data-v-68fa0602>Tax</text><rect x="450" y="170" width="100" height="40" rx="4" fill="var(--color-accent)" opacity="0.8" data-v-68fa0602></rect><text x="500" y="195" text-anchor="middle" fill="white" font-size="12" font-weight="bold" data-v-68fa0602>Invested</text></g><path d="M 150 70 C 200 70, 200 120, 250 120" stroke="var(--color-success)" stroke-width="15" fill="none" opacity="0.2" data-v-68fa0602></path><path d="M 150 130 C 200 130, 200 150, 250 150" stroke="var(--color-success)" stroke-width="10" fill="none" opacity="0.2" data-v-68fa0602></path><path d="M 150 190 C 200 190, 200 180, 250 180" stroke="var(--color-success)" stroke-width="8" fill="none" opacity="0.2" data-v-68fa0602></path><path d="M 350 120 C 400 120, 400 70, 450 70" stroke="var(--color-danger)" stroke-width="15" fill="none" opacity="0.2" data-v-68fa0602></path><path d="M 350 150 C 400 150, 400 130, 450 130" stroke="var(--color-danger)" stroke-width="12" fill="none" opacity="0.2" data-v-68fa0602></path><path d="M 350 180 C 400 180, 400 190, 450 190" stroke="var(--color-accent)" stroke-width="10" fill="none" opacity="0.2" data-v-68fa0602></path></svg></div><div class="mt-6 p-4 bg-muted rounded-lg text-xs text-muted flex items-center gap-2" data-v-68fa0602><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-68fa0602><circle cx="12" cy="12" r="10" data-v-68fa0602></circle><line x1="12" y1="16" x2="12" y2="12" data-v-68fa0602></line><line x1="12" y1="8" x2="12.01" y2="8" data-v-68fa0602></line></svg> This diagram visualizes how your total annual income is distributed between consumption, taxation, and wealth creation. </div>',3)])])}const at=F(Z,[["render",et],["__scopeId","data-v-68fa0602"]]),st={class:"fi-view"},ot={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},nt={class:"card p-6"},lt={class:"space-y-6"},it={class:"form-group"},rt={class:"label flex justify-between"},dt={class:"text-accent font-bold"},ct={class:"form-group"},ut={class:"label flex justify-between"},pt={class:"text-accent font-bold"},vt={class:"form-group"},ft={class:"label flex justify-between"},xt={class:"text-accent font-bold"},mt={class:"form-group"},ht={class:"label flex justify-between"},gt={class:"text-accent font-bold"},bt={class:"form-group"},yt={class:"form-group"},wt=["disabled"],_t={key:0},kt={key:1},Ct={class:"lg:col-span-2 space-y-6"},It={class:"flex gap-2"},Bt={key:0,class:"space-y-6"},Pt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},At={class:"card p-6 flex flex-col items-center justify-center text-center"},$t={class:"relative w-48 h-48 mb-4"},Mt={viewBox:"0 0 100 100",class:"w-full h-full transform -rotate-90"},Rt=["stroke","stroke-dashoffset"],jt={class:"absolute inset-0 flex flex-col items-center justify-center"},St={class:"text-4xl font-bold"},Vt={class:"card p-6 grid grid-cols-1 gap-4"},Tt={class:"p-4 bg-elevated rounded-lg"},Ft={class:"text-2xl font-bold text-accent"},zt={class:"grid grid-cols-2 gap-4"},Nt={class:"p-4 bg-elevated rounded-lg"},Ot={class:"text-xl font-bold text-danger"},Ut={class:"p-4 bg-elevated rounded-lg"},Ht={class:"text-xl font-bold text-success"},Lt={class:"grid grid-cols-2 gap-4 border-t border-border pt-4 mt-2"},Dt={class:"flex flex-col"},Et={class:"text-sm font-bold"},Gt={class:"flex flex-col"},Wt={class:"text-sm font-bold"},Kt={class:"card p-6"},Yt={class:"h-80"},qt={key:1,class:"h-full flex items-center justify-center text-muted italic"},Jt={key:1,class:"card h-[600px] flex flex-col overflow-hidden"},Qt={class:"text-sm whitespace-pre-wrap"},Xt={key:0,class:"flex justify-start"},Zt={class:"p-4 border-t border-border bg-muted flex gap-2"},te=["disabled"],ee=["disabled"],T=5e3,ae={__name:"FinancialIndependenceView",setup(z){const p=Q(),g=l(!1),v=l("simulator"),m=l(""),f=l(!1),b=l([{role:"ai",text:"Hello! I am your AI Financial Advisor. How can I help you with your retirement planning today?"}]),y=l(null),a=q({retirementAge:65,targetIncome:8e4,initialBalance:5e5,annualContribution:3e4,expectedReturn:7,volatility:15,inflationRate:2.5,years:40,includeAgePension:!0}),x=l(0),P=l(0),A=l(0),$=l(0),M=l([]),N=_(()=>x.value>.8?"#10b981":x.value>.6?"#f59e0b":"#ef4444"),d=o=>o==null?"0":X(o,0),R=_(()=>a.targetIncome*25),O=_(()=>{const o=a.retirementAge-45;return o<=0?a.initialBalance:R.value/Math.pow(1+a.expectedReturn/100,o)}),U=async()=>{g.value=!0;try{const e=(await I.post("/Retirement/simulate",{},{params:{scenarioId:"00000000-0000-0000-0000-000000000000"}}).catch(()=>I.post("/StressTest/simulate",{iterations:T,years:a.years,initialBalance:a.initialBalance,annualContribution:a.annualContribution,expectedReturn:a.expectedReturn/100,volatility:a.volatility/100,inflationRate:a.inflationRate/100,targetIncome:a.targetIncome,retirementYear:a.retirementAge-45,includeAgePension:a.includeAgePension},{params:{portfolioId:p.currentPortfolio?.id}}))).data;x.value=e.successProbability,P.value=e.medianOutcome,A.value=e.worstCaseOutcome,$.value=e.bestCaseOutcome,V.value=[{name:"Median",data:e.medianPath},{name:"P10 (Worst)",data:e.p10Path},{name:"P90 (Best)",data:e.p90Path}],M.value=e.medianPath}catch(o){console.error("Simulation failed",o)}finally{g.value=!1}},j=async()=>{if(!m.value.trim()||f.value)return;const o=m.value;m.value="",b.value.push({role:"user",text:o}),f.value=!0,S();try{const e=`
      User is targetting retirement at age ${a.retirementAge}.
      Target annual income: $${a.targetIncome}.
      Current initial balance: $${a.initialBalance}.
      Annual contribution: $${a.annualContribution}.
      Expected market return: ${a.expectedReturn}%.
      Current Success Probability: ${(x.value*100).toFixed(0)}%.
    `,k=await I.post("/AI/chat",{message:o,context:e});b.value.push({role:"ai",text:k.data.response})}catch{b.value.push({role:"ai",text:"Sorry, I encountered an error processing your request."})}finally{f.value=!1,S()}},S=()=>{setTimeout(()=>{y.value&&(y.value.scrollTop=y.value.scrollHeight)},100)},V=l([]),H=_(()=>({chart:{type:"line",toolbar:{show:!1},animations:{enabled:!0},background:"transparent"},stroke:{curve:"smooth",width:[3,2,2],dashArray:[0,4,4]},colors:["#3b82f6","#ef4444","#10b981"],xaxis:{title:{text:"Years"},labels:{style:{colors:"var(--color-text-muted)"}}},yaxis:{labels:{formatter:o=>"$"+(o/1e3).toFixed(0)+"k",style:{colors:"var(--color-text-muted)"}}},grid:{borderColor:"var(--color-border-subtle)",xaxis:{lines:{show:!1}}},legend:{show:!1},tooltip:{theme:"dark",y:{formatter:o=>"$"+o.toLocaleString()}}}));return D(()=>{p.currentPortfolio&&(a.initialBalance=p.currentPortfolioValue||5e5)}),(o,e)=>{const k=J("apexchart");return i(),r("div",st,[t("div",ot,[t("div",nt,[e[16]||(e[16]=t("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 20h9"}),t("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"})]),h(" Retirement Params ")],-1)),t("div",lt,[t("div",it,[t("label",rt,[e[9]||(e[9]=h(" Retirement Age ",-1)),t("span",dt,n(a.retirementAge),1)]),c(t("input",{type:"range","onUpdate:modelValue":e[0]||(e[0]=s=>a.retirementAge=s),min:"30",max:"80",class:"slider"},null,512),[[u,a.retirementAge,void 0,{number:!0}]])]),t("div",ct,[t("label",ut,[e[10]||(e[10]=h(" Target Annual Income ",-1)),t("span",pt,"$"+n(d(a.targetIncome)),1)]),c(t("input",{type:"range","onUpdate:modelValue":e[1]||(e[1]=s=>a.targetIncome=s),min:"20000",max:"300000",step:"5000",class:"slider"},null,512),[[u,a.targetIncome,void 0,{number:!0}]])]),t("div",vt,[t("label",ft,[e[11]||(e[11]=h(" Initial Balance ",-1)),t("span",xt,"$"+n(d(a.initialBalance)),1)]),c(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>a.initialBalance=s),class:"input"},null,512),[[u,a.initialBalance,void 0,{number:!0}]])]),t("div",mt,[t("label",ht,[e[12]||(e[12]=h(" Annual Contribution ",-1)),t("span",gt,"$"+n(d(a.annualContribution)),1)]),c(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=s=>a.annualContribution=s),class:"input"},null,512),[[u,a.annualContribution,void 0,{number:!0}]])]),e[15]||(e[15]=t("div",{class:"divider"},null,-1)),t("div",bt,[e[13]||(e[13]=t("label",{class:"label"},"Expected Return (%)",-1)),c(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>a.expectedReturn=s),step:"0.1",class:"input"},null,512),[[u,a.expectedReturn,void 0,{number:!0}]])]),t("div",yt,[e[14]||(e[14]=t("label",{class:"label"},"Volatility (%)",-1)),c(t("input",{type:"number","onUpdate:modelValue":e[5]||(e[5]=s=>a.volatility=s),step:"0.1",class:"input"},null,512),[[u,a.volatility,void 0,{number:!0}]])]),t("button",{onClick:U,class:"btn btn-primary w-full py-3 mt-4",disabled:g.value},[g.value?(i(),r("span",_t,"Simulating...")):(i(),r("span",kt,"Run Simulation"))],8,wt)])]),t("div",Ct,[t("div",It,[t("button",{onClick:e[6]||(e[6]=s=>v.value="simulator"),class:w(["px-6 py-2 rounded-lg font-bold transition-all",v.value==="simulator"?"bg-accent text-white shadow-accent":"bg-elevated text-muted hover:text-primary"])}," Simulator ",2),t("button",{onClick:e[7]||(e[7]=s=>v.value="advisor"),class:w(["px-6 py-2 rounded-lg font-bold transition-all",v.value==="advisor"?"bg-accent text-white shadow-accent":"bg-elevated text-muted hover:text-primary"])}," AI Advisor ",2)]),v.value==="simulator"?(i(),r("div",Bt,[t("div",Pt,[t("div",At,[e[19]||(e[19]=t("h3",{class:"text-sm font-medium text-muted mb-4 uppercase tracking-wider"},"Success Probability",-1)),t("div",$t,[(i(),r("svg",Mt,[e[17]||(e[17]=t("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"var(--color-bg-elevated)","stroke-width":"8"},null,-1)),t("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:N.value,"stroke-width":"8","stroke-dasharray":"283","stroke-dashoffset":283-283*x.value,"stroke-linecap":"round",class:"transition-all duration-1000 ease-out"},null,8,Rt)])),t("div",jt,[t("span",St,n((x.value*100).toFixed(0))+"%",1),e[18]||(e[18]=t("span",{class:"text-xs text-muted uppercase"},"Success Rate",-1))])]),t("p",{class:"text-sm text-muted max-w-xs"}," Based on "+n(T)+" simulations of market volatility. ")]),t("div",Vt,[t("div",Tt,[e[20]||(e[20]=t("span",{class:"text-xs text-muted uppercase"},"Median Final Outcome",-1)),t("div",Ft,"$"+n(d(P.value/1e6))+"M",1)]),t("div",zt,[t("div",Nt,[e[21]||(e[21]=t("span",{class:"text-xs text-muted uppercase"},"P10 (Worst)",-1)),t("div",Ot,"$"+n(d(A.value/1e6))+"M",1)]),t("div",Ut,[e[22]||(e[22]=t("span",{class:"text-xs text-muted uppercase"},"P90 (Best)",-1)),t("div",Ht,"$"+n(d($.value/1e6))+"M",1)])]),t("div",Lt,[t("div",Dt,[e[23]||(e[23]=t("span",{class:"text-[10px] text-muted uppercase"},"Coast FI Target",-1)),t("div",Et,"$"+n(d(O.value)),1)]),t("div",Gt,[e[24]||(e[24]=t("span",{class:"text-[10px] text-muted uppercase"},"FI Number",-1)),t("div",Wt,"$"+n(d(R.value)),1)])])])]),t("div",Kt,[e[25]||(e[25]=B('<div class="flex justify-between items-center mb-6" data-v-f8c4e343><h3 class="text-lg font-bold" data-v-f8c4e343>Wealth Projection</h3><div class="flex gap-4 text-xs" data-v-f8c4e343><span class="flex items-center gap-1" data-v-f8c4e343><span class="w-3 h-3 bg-accent rounded-full" data-v-f8c4e343></span> Median</span><span class="flex items-center gap-1" data-v-f8c4e343><span class="w-3 h-3 bg-danger opacity-50 rounded-full" data-v-f8c4e343></span> P10</span><span class="flex items-center gap-1" data-v-f8c4e343><span class="w-3 h-3 bg-success opacity-50 rounded-full" data-v-f8c4e343></span> P90</span></div></div>',1)),t("div",Yt,[M.value.length?(i(),E(k,{key:0,type:"line",height:"100%",options:H.value,series:V.value},null,8,["options","series"])):(i(),r("div",qt," Run simulation to see results "))])])])):C("",!0),G(at,{class:"mt-6"}),v.value==="advisor"?(i(),r("div",Jt,[e[28]||(e[28]=B('<div class="p-4 border-b border-border bg-muted flex items-center gap-3" data-v-f8c4e343><div class="w-10 h-10 bg-accent rounded-full flex items-center justify-center text-white" data-v-f8c4e343><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-f8c4e343><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" data-v-f8c4e343></path></svg></div><div data-v-f8c4e343><div class="font-bold" data-v-f8c4e343>Gemini Advisor</div><div class="text-xs text-muted" data-v-f8c4e343>Powered by Google Gemini</div></div></div>',1)),t("div",{class:"flex-1 overflow-y-auto p-6 space-y-4",ref_key:"chatContainer",ref:y},[(i(!0),r(W,null,K(b.value,(s,L)=>(i(),r("div",{key:L,class:w(["flex",s.role==="user"?"justify-end":"justify-start"])},[t("div",{class:w(["max-w-[80%] p-4 rounded-2xl",s.role==="user"?"bg-accent text-white rounded-tr-none":"bg-elevated text-primary rounded-tl-none"])},[t("div",Qt,n(s.text),1)],2)],2))),128)),f.value?(i(),r("div",Xt,[...e[26]||(e[26]=[t("div",{class:"bg-elevated p-4 rounded-2xl rounded-tl-none flex gap-1"},[t("span",{class:"w-2 h-2 bg-muted rounded-full animate-bounce"}),t("span",{class:"w-2 h-2 bg-muted rounded-full animate-bounce delay-100"}),t("span",{class:"w-2 h-2 bg-muted rounded-full animate-bounce delay-200"})],-1)])])):C("",!0)],512),t("div",Zt,[c(t("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=s=>m.value=s),onKeyup:Y(j,["enter"]),placeholder:"Ask about your retirement strategy...",class:"flex-1 input",disabled:f.value},null,40,te),[[u,m.value]]),t("button",{onClick:j,class:"btn btn-primary px-6",disabled:f.value},[...e[27]||(e[27]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),t("polyline",{points:"22 2 15 22 11 13 2 9 22 2"})],-1)])],8,ee)])])):C("",!0)])])])}}},le=F(ae,[["__scopeId","data-v-f8c4e343"]]);export{le as default};
