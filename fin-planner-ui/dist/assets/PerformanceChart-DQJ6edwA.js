import{w as h,x,r as D,o as d,c as v,a as t,p as C,C as A,F as B,l as I,n as L,t as P,i as V,s as y,g as p,z as f}from"./index-oVbs5Hxd.js";const M={class:"performance-chart card"},F={class:"chart-header"},Y={class:"controls-row"},$={class:"benchmark-selector"},z={class:"range-selector"},N=["onClick"],O={class:"chart-container"},T={key:1,class:"empty-chart"},X={__name:"PerformanceChart",props:{portfolioId:String,benchmark:String},setup(b){const r=b,c=p("1Y"),l=p(""),g=["1M","3M","6M","1Y","3Y","5Y","ALL"],n=p([]),s=p([]),k=f(()=>n.value.length>0),_=f(()=>{const e=[{name:"Portfolio Value",data:n.value.map(a=>[new Date(a.date).getTime(),a.totalValue])}];if(s.value&&s.value.length>0){const a=n.value[0]?.totalValue||0,u=s.value[0]?.price||1,o=a/u;e.push({name:l.value,data:s.value.map(m=>[new Date(m.date).getTime(),m.price*o])})}return e}),w=f(()=>({chart:{type:"area",toolbar:{show:!1},animations:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:[3,2],dashArray:[0,5]},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.3}},xaxis:{type:"datetime",tooltip:{enabled:!1}},yaxis:{labels:{formatter:e=>"$"+(e/1e3).toFixed(1)+"k"}},theme:{mode:"dark",palette:"palette1"},colors:["#3b82f6","#9ca3af"],grid:{borderColor:"#333"},legend:{position:"top",horizontalAlign:"left"}})),i=async()=>{if(r.portfolioId)try{const e=await y.get(`/reports/performance/${r.portfolioId}`,{params:{range:c.value,benchmark:l.value}});e.data.portfolio?(n.value=e.data.portfolio,s.value=e.data.benchmark||[]):(n.value=e.data,s.value=[])}catch(e){console.error(e)}},S=async()=>{if(r.portfolioId)try{await y.post(`/reports/rebuild-history/${r.portfolioId}`),await i()}catch(e){console.error(e)}};return h(()=>r.portfolioId,i),h(l,i),h(c,i),x(i),(e,a)=>{const u=D("apexchart");return d(),v("div",M,[t("div",F,[a[2]||(a[2]=t("h3",null,"Portfolio Performance",-1)),t("div",Y,[t("div",$,[C(t("select",{"onUpdate:modelValue":a[0]||(a[0]=o=>l.value=o),class:"form-select-sm"},[...a[1]||(a[1]=[t("option",{value:""},"No Benchmark",-1),t("option",{value:"ASX200"},"ASX 200",-1),t("option",{value:"S&P500"},"S&P 500",-1),t("option",{value:"ALLORDS"},"All Ordinaries",-1)])],512),[[A,l.value]])]),t("div",z,[(d(),v(B,null,I(g,o=>t("button",{key:o,class:L({active:c.value===o}),onClick:m=>c.value=o},P(o),11,N)),64))])])]),t("div",O,[k.value?(d(),V(u,{key:0,type:"area",height:"350",options:w.value,series:_.value},null,8,["options","series"])):(d(),v("div",T,[a[3]||(a[3]=t("p",null,"No performance data available.",-1)),t("button",{onClick:S,class:"btn btn-primary btn-sm"},"Build History")]))])])}}};export{X as _};
