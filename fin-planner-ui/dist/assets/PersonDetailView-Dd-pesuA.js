import{_ as L,r as v,i as j,c as r,d as w,o as n,a as t,v as J,e as K,w as Q,f as X,t as o,n as Z,F as $,q as S,s as tt,m as g,x as i,z as d,y as A,g as B,A as et,G as st,B as f,l as lt}from"./index-D2Wtd9Sa.js";const at={key:0,class:"person-detail animate-fade-in"},ot={class:"header-row"},nt={class:"header-content"},it={class:"breadcrumb"},rt={class:"current"},dt={class:"meta-row"},ut={class:"meta-item"},vt={class:"meta-item"},mt={class:"actions"},ct={class:"detail-grid"},pt={class:"main-column"},bt={class:"card section-card"},ft={key:0,class:"empty-state-mini"},yt={key:1,class:"data-table"},gt={class:"text-right font-semibold"},xt={class:"text-right text-danger"},ht={class:"text-right text-success"},_t={class:"text-right"},kt=["onClick"],Ct={class:"card section-card mt-xl"},wt={key:0,class:"empty-state-mini"},Dt={key:1,class:"data-table"},$t={class:"badge"},St={class:"text-right font-semibold text-danger"},Nt={class:"text-right"},Vt=["onClick"],At={class:"side-column"},Bt={class:"card tax-summary-card gradient-blue"},It={class:"tax-metric"},Ft={class:"value"},Ut={class:"tax-metric"},Tt={class:"value"},Pt={class:"tax-metric"},Rt={class:"value"},Mt={class:"progress-bar"},Ot={class:"card section-card mt-xl"},Yt={class:"super-info"},qt={class:"fund-name"},Et={class:"fund-meta"},Wt={class:"super-balance"},Ht=["onClick"],Gt={key:0,class:"empty-state-mini"},zt={class:"modal-card"},Lt={class:"modal-header"},jt={class:"form-group"},Jt={class:"form-group"},Kt={class:"form-group"},Qt={class:"form-group"},Xt={class:"checkbox-label"},Zt={class:"modal-actions"},te=["disabled"],ee={class:"modal-card"},se={class:"modal-header"},le={class:"form-group"},ae={class:"form-row"},oe={class:"form-group"},ne={class:"form-group"},ie={class:"form-row"},re={class:"form-group"},de={class:"form-group"},ue={class:"modal-actions"},ve=["disabled"],me={class:"modal-card"},ce={class:"modal-header"},pe={class:"form-group"},be={class:"form-group"},fe={class:"form-row"},ye={class:"form-group"},ge={class:"form-group"},xe={class:"modal-actions"},he=["disabled"],_e={class:"modal-card"},ke={class:"modal-header"},Ce={class:"form-group"},we={class:"form-row"},De={class:"form-group"},$e={class:"form-group"},Se={class:"form-group"},Ne={class:"modal-actions"},Ve=["disabled"],Ae={__name:"PersonDetailView",setup(Be){const N=lt(),a=v(null),D=v(null),I=v(!0),u=v(!1),h=v(!1),_=v(!1),k=v(!1),C=v(!1),c=v({}),m=v({employer:"",fiscalYear:2025,grossSalary:0,taxWithheld:0,superContribution:0}),p=v({category:"WorkRelated",description:"",fiscalYear:2025,amount:0}),b=v({fundName:"",memberNumber:"",currentBalance:0,investmentOption:"Balanced",preservationDate:new Date("2050-01-01").toISOString()}),y=async()=>{try{const[l,e]=await Promise.all([f.get(`/persons/${N.params.id}`),f.get(`/persons/${N.params.id}/tax-position`)]);a.value=l.data,D.value=e.data,c.value={...l.data,dateOfBirth:l.data.dateOfBirth?.split("T")[0]}}catch(l){console.error("Failed to load person data",l)}finally{I.value=!1}},F=async()=>{u.value=!0;try{await f.put(`/persons/${a.value.id}`,c.value),h.value=!1,await y()}catch{alert("Update failed")}finally{u.value=!1}},U=()=>{_.value=!0},T=async()=>{u.value=!0;try{await f.post(`/persons/${a.value.id}/income`,m.value),_.value=!1,await y()}catch{alert("Failed to add income")}finally{u.value=!1}},P=async l=>{if(confirm("Delete this income record?"))try{await f.delete(`/persons/${a.value.id}/income/${l}`),await y()}catch{alert("Delete failed")}},R=()=>{k.value=!0},M=async()=>{u.value=!0;try{await f.post(`/persons/${a.value.id}/deductions`,p.value),k.value=!1,await y()}catch{alert("Failed to add deduction")}finally{u.value=!1}},O=async l=>{if(confirm("Delete this deduction record?"))try{await f.delete(`/persons/${a.value.id}/deductions/${l}`),await y()}catch{alert("Delete failed")}},Y=()=>{C.value=!0},q=async()=>{u.value=!0;try{await f.post(`/persons/${a.value.id}/super`,b.value),C.value=!1,await y()}catch{alert("Failed to add super account")}finally{u.value=!1}},E=async l=>{if(confirm("Delete this super account?"))try{await f.delete(`/persons/${a.value.id}/super/${l}`),await y()}catch{alert("Delete failed")}},W=l=>l?new Date(l).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"}):"N/A",x=l=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD"}).format(l||0),H=l=>l<=.19?"tax-low-text":l<=.325?"tax-medium-text":"tax-high-text",G=l=>Math.min(100,l/2e5*100);return j(y),(l,e)=>{const z=X("router-link");return a.value?(n(),r("div",at,[t("div",ot,[t("div",nt,[t("div",it,[K(z,{to:"/entities"},{default:Q(()=>[...e[30]||(e[30]=[B("Entities",-1)])]),_:1}),e[31]||(e[31]=t("span",{class:"separator"},"/",-1)),t("span",rt,o(a.value.fullName),1)]),t("h1",null,o(a.value.fullName),1),t("div",dt,[t("span",ut,"ðŸŽ‚ "+o(W(a.value.dateOfBirth)),1),t("span",{class:Z(["meta-item",H(a.value.marginalTaxRate)])}," ðŸ“Š "+o((a.value.marginalTaxRate*100).toFixed(1))+"% Effective Marginal Rate ",3),t("span",vt,"ðŸ›¡ï¸ "+o(a.value.hasPrivateHealthInsurance?"Private Health Insurance":"No Private Health"),1)])]),t("div",mt,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=s=>h.value=!0)},"Edit Profile")])]),t("div",ct,[t("div",pt,[t("div",bt,[t("div",{class:"section-header"},[e[32]||(e[32]=t("h2",null,"ðŸ’¼ Payroll Income",-1)),t("button",{class:"btn btn-secondary btn-sm",onClick:U},"Add Income")]),a.value.payrollIncomes?.length===0?(n(),r("div",ft," No payroll records found. ")):(n(),r("table",yt,[e[33]||(e[33]=t("thead",null,[t("tr",null,[t("th",null,"Employer"),t("th",null,"FY"),t("th",{class:"text-right"},"Gross Salary"),t("th",{class:"text-right"},"Tax Withheld"),t("th",{class:"text-right"},"Super"),t("th",{class:"text-right"},"Actions")])],-1)),t("tbody",null,[(n(!0),r($,null,S(a.value.payrollIncomes,s=>(n(),r("tr",{key:s.id},[t("td",null,o(s.employer),1),t("td",null,"FY"+o(s.fiscalYear),1),t("td",gt,o(x(s.grossSalary)),1),t("td",xt,o(x(s.taxWithheld)),1),t("td",ht,o(x(s.superContribution)),1),t("td",_t,[t("button",{class:"btn-icon btn-danger-text",onClick:V=>P(s.id)},"ðŸ—‘ï¸",8,kt)])]))),128))])]))]),t("div",Ct,[t("div",{class:"section-header"},[e[34]||(e[34]=t("h2",null,"ðŸ“ Deductions",-1)),t("button",{class:"btn btn-secondary btn-sm",onClick:R},"Add Deduction")]),a.value.deductions?.length===0?(n(),r("div",wt," No deductions recorded. ")):(n(),r("table",Dt,[e[35]||(e[35]=t("thead",null,[t("tr",null,[t("th",null,"Category"),t("th",null,"Description"),t("th",null,"FY"),t("th",{class:"text-right"},"Amount"),t("th",{class:"text-right"},"Actions")])],-1)),t("tbody",null,[(n(!0),r($,null,S(a.value.deductions,s=>(n(),r("tr",{key:s.id},[t("td",null,[t("span",$t,o(s.category),1)]),t("td",null,o(s.description),1),t("td",null,"FY"+o(s.fiscalYear),1),t("td",St,o(x(s.amount)),1),t("td",Nt,[t("button",{class:"btn-icon btn-danger-text",onClick:V=>O(s.id)},"ðŸ—‘ï¸",8,Vt)])]))),128))])]))])]),t("div",At,[t("div",Bt,[e[39]||(e[39]=t("h3",null,"âš¡ Tax Position Summary",-1)),t("div",It,[e[36]||(e[36]=t("span",{class:"label"},"Taxable Income (Est)",-1)),t("span",Ft,o(x(D.value?.taxableIncomeBeforeDistribution)),1)]),t("div",Ut,[e[37]||(e[37]=t("span",{class:"label"},"Total Tax (Est)",-1)),t("span",Tt,o(x(D.value?.taxPayableBeforeDistribution)),1)]),t("div",Pt,[e[38]||(e[38]=t("span",{class:"label"},"Marginal Bracket",-1)),t("span",Rt,o((D.value?.marginalTaxRate*100).toFixed(1))+"%",1)]),t("div",Mt,[t("div",{class:"progress-fill",style:tt({width:G(D.value?.taxableIncomeBeforeDistribution)+"%"})},null,4)])]),t("div",Ot,[t("div",{class:"section-header"},[e[40]||(e[40]=t("h2",null,"ðŸ¦ Superannuation",-1)),t("button",{class:"btn btn-secondary btn-sm",onClick:Y},"Add Super")]),(n(!0),r($,null,S(a.value.superAccounts,s=>(n(),r("div",{key:s.id,class:"super-item"},[t("div",Yt,[t("div",qt,o(s.fundName),1),t("div",Et,o(s.investmentOption)+" â€¢ Member "+o(s.memberNumber||"N/A"),1)]),t("div",Wt,o(x(s.currentBalance)),1),t("button",{class:"btn-icon",onClick:V=>E(s.id)},"ðŸ—‘ï¸",8,Ht)]))),128)),a.value.superAccounts?.length===0?(n(),r("div",Gt," No super accounts linked. ")):w("",!0)])])]),(n(),J(st,{to:"body"},[h.value?(n(),r("div",{key:0,class:"modal-overlay",onClick:e[7]||(e[7]=g(s=>h.value=!1,["self"]))},[t("div",zt,[t("div",Lt,[e[41]||(e[41]=t("h2",null,"Edit Profile",-1)),t("button",{class:"btn-close",onClick:e[1]||(e[1]=s=>h.value=!1)},"Ã—")]),t("form",{onSubmit:g(F,["prevent"]),class:"modal-form"},[t("div",jt,[e[42]||(e[42]=t("label",null,"Full Name",-1)),i(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>c.value.fullName=s),type:"text",required:""},null,512),[[d,c.value.fullName]])]),t("div",Jt,[e[43]||(e[43]=t("label",null,"Date of Birth",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>c.value.dateOfBirth=s),type:"date",required:""},null,512),[[d,c.value.dateOfBirth]])]),t("div",Kt,[e[45]||(e[45]=t("label",null,"Marginal Tax Rate Override",-1)),i(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>c.value.marginalTaxRate=s)},[...e[44]||(e[44]=[t("option",{value:0},"0%",-1),t("option",{value:.19},"19%",-1),t("option",{value:.3},"30%",-1),t("option",{value:.37},"37%",-1),t("option",{value:.45},"45%",-1)])],512),[[A,c.value.marginalTaxRate]])]),t("div",Qt,[t("label",Xt,[i(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>c.value.hasPrivateHealthInsurance=s)},null,512),[[et,c.value.hasPrivateHealthInsurance]]),e[46]||(e[46]=B(" Has private health insurance ",-1))])]),t("div",Zt,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=s=>h.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:u.value},"Save Changes",8,te)])],32)])])):w("",!0),_.value?(n(),r("div",{key:1,class:"modal-overlay",onClick:e[15]||(e[15]=g(s=>_.value=!1,["self"]))},[t("div",ee,[t("div",se,[e[47]||(e[47]=t("h2",null,"Add Payroll Income",-1)),t("button",{class:"btn-close",onClick:e[8]||(e[8]=s=>_.value=!1)},"Ã—")]),t("form",{onSubmit:g(T,["prevent"]),class:"modal-form"},[t("div",le,[e[48]||(e[48]=t("label",null,"Employer",-1)),i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>m.value.employer=s),type:"text",required:""},null,512),[[d,m.value.employer]])]),t("div",ae,[t("div",oe,[e[49]||(e[49]=t("label",null,"Fiscal Year",-1)),i(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>m.value.fiscalYear=s),type:"number",required:""},null,512),[[d,m.value.fiscalYear,void 0,{number:!0}]])]),t("div",ne,[e[50]||(e[50]=t("label",null,"Gross Salary",-1)),i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>m.value.grossSalary=s),type:"number",step:"0.01",required:""},null,512),[[d,m.value.grossSalary,void 0,{number:!0}]])])]),t("div",ie,[t("div",re,[e[51]||(e[51]=t("label",null,"Tax Withheld",-1)),i(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>m.value.taxWithheld=s),type:"number",step:"0.01",required:""},null,512),[[d,m.value.taxWithheld,void 0,{number:!0}]])]),t("div",de,[e[52]||(e[52]=t("label",null,"Super Guarantee",-1)),i(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>m.value.superContribution=s),type:"number",step:"0.01",required:""},null,512),[[d,m.value.superContribution,void 0,{number:!0}]])])]),t("div",ue,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[14]||(e[14]=s=>_.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:u.value},"Add Record",8,ve)])],32)])])):w("",!0),k.value?(n(),r("div",{key:2,class:"modal-overlay",onClick:e[22]||(e[22]=g(s=>k.value=!1,["self"]))},[t("div",me,[t("div",ce,[e[53]||(e[53]=t("h2",null,"Add Deduction",-1)),t("button",{class:"btn-close",onClick:e[16]||(e[16]=s=>k.value=!1)},"Ã—")]),t("form",{onSubmit:g(M,["prevent"]),class:"modal-form"},[t("div",pe,[e[55]||(e[55]=t("label",null,"Category",-1)),i(t("select",{"onUpdate:modelValue":e[17]||(e[17]=s=>p.value.category=s)},[...e[54]||(e[54]=[t("option",{value:"WorkRelated"},"Work Related",-1),t("option",{value:"Investment"},"Investment Expense",-1),t("option",{value:"Donation"},"Charitable Donation",-1),t("option",{value:"Other"},"Other",-1)])],512),[[A,p.value.category]])]),t("div",be,[e[56]||(e[56]=t("label",null,"Description",-1)),i(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>p.value.description=s),type:"text",required:""},null,512),[[d,p.value.description]])]),t("div",fe,[t("div",ye,[e[57]||(e[57]=t("label",null,"Fiscal Year",-1)),i(t("input",{"onUpdate:modelValue":e[19]||(e[19]=s=>p.value.fiscalYear=s),type:"number",required:""},null,512),[[d,p.value.fiscalYear,void 0,{number:!0}]])]),t("div",ge,[e[58]||(e[58]=t("label",null,"Amount",-1)),i(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>p.value.amount=s),type:"number",step:"0.01",required:""},null,512),[[d,p.value.amount,void 0,{number:!0}]])])]),t("div",xe,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[21]||(e[21]=s=>k.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:u.value},"Add Record",8,he)])],32)])])):w("",!0),C.value?(n(),r("div",{key:3,class:"modal-overlay",onClick:e[29]||(e[29]=g(s=>C.value=!1,["self"]))},[t("div",_e,[t("div",ke,[e[59]||(e[59]=t("h2",null,"Add Superannuation Account",-1)),t("button",{class:"btn-close",onClick:e[23]||(e[23]=s=>C.value=!1)},"Ã—")]),t("form",{onSubmit:g(q,["prevent"]),class:"modal-form"},[t("div",Ce,[e[60]||(e[60]=t("label",null,"Fund Name",-1)),i(t("input",{"onUpdate:modelValue":e[24]||(e[24]=s=>b.value.fundName=s),type:"text",required:"",placeholder:"e.g. AustralianSuper"},null,512),[[d,b.value.fundName]])]),t("div",we,[t("div",De,[e[61]||(e[61]=t("label",null,"Member Number",-1)),i(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>b.value.memberNumber=s),type:"text"},null,512),[[d,b.value.memberNumber]])]),t("div",$e,[e[62]||(e[62]=t("label",null,"Current Balance",-1)),i(t("input",{"onUpdate:modelValue":e[26]||(e[26]=s=>b.value.currentBalance=s),type:"number",step:"0.01",required:""},null,512),[[d,b.value.currentBalance,void 0,{number:!0}]])])]),t("div",Se,[e[63]||(e[63]=t("label",null,"Investment Option",-1)),i(t("input",{"onUpdate:modelValue":e[27]||(e[27]=s=>b.value.investmentOption=s),type:"text",placeholder:"Balanced, High Growth, etc."},null,512),[[d,b.value.investmentOption]])]),t("div",Ne,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[28]||(e[28]=s=>C.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:u.value},"Add Account",8,Ve)])],32)])])):w("",!0)]))])):w("",!0)}}},Fe=L(Ae,[["__scopeId","data-v-c71a35c9"]]);export{Fe as default};
