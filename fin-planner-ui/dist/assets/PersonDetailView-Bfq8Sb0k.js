import{_ as j,g as v,x as L,o as n,c as d,a as t,d as J,j as K,t as o,k as g,n as Q,F as S,l as N,B as X,f as D,i as Z,m as x,p as i,v as r,C as I,q as tt,e as F,G as et,s as f,r as st,A as lt}from"./index-oVbs5Hxd.js";import{a as at,f as h}from"./formatters-DwG4QyEz.js";const ot={key:0,class:"person-detail animate-fade-in"},nt={class:"header-row"},it={class:"header-content"},dt={class:"breadcrumb"},rt={class:"current"},ut={class:"meta-row"},vt={class:"meta-item"},mt={class:"meta-item"},pt={class:"actions"},ct={class:"detail-grid"},bt={class:"main-column"},ft={class:"card section-card"},yt={key:0,class:"empty-state-mini"},gt={key:1,class:"data-table"},xt={class:"text-right font-semibold"},ht={class:"text-right text-danger"},kt={class:"text-right text-success"},_t={class:"text-right"},Ct=["onClick"],wt={class:"card section-card mt-xl"},Dt={key:0,class:"empty-state-mini"},$t={key:1,class:"data-table"},St={class:"badge"},Nt={class:"text-right font-semibold text-danger"},Vt={class:"text-right"},Bt=["onClick"],It={class:"side-column"},Ft={class:"card tax-summary-card gradient-blue"},At={class:"tax-metric"},Tt={class:"value"},Ut={class:"tax-metric"},Pt={class:"value"},Rt={class:"tax-metric"},Mt={class:"value"},Ot={class:"progress-bar"},Yt={class:"card section-card mt-xl"},qt={class:"super-info"},Et={class:"fund-name"},Wt={class:"fund-meta"},Ht={class:"super-balance"},Gt=["onClick"],zt={key:0,class:"empty-state-mini"},jt={class:"modal-card"},Lt={class:"modal-header"},Jt={class:"form-group"},Kt={class:"form-group"},Qt={class:"form-group"},Xt={class:"form-group"},Zt={class:"checkbox-label"},te={class:"modal-actions"},ee=["disabled"],se={class:"modal-card"},le={class:"modal-header"},ae={class:"form-group"},oe={class:"form-row"},ne={class:"form-group"},ie={class:"form-group"},de={class:"form-row"},re={class:"form-group"},ue={class:"form-group"},ve={class:"modal-actions"},me=["disabled"],pe={class:"modal-card"},ce={class:"modal-header"},be={class:"form-group"},fe={class:"form-group"},ye={class:"form-row"},ge={class:"form-group"},xe={class:"form-group"},he={class:"modal-actions"},ke=["disabled"],_e={class:"modal-card"},Ce={class:"modal-header"},we={class:"form-group"},De={class:"form-row"},$e={class:"form-group"},Se={class:"form-group"},Ne={class:"form-group"},Ve={class:"modal-actions"},Be=["disabled"],Ie={__name:"PersonDetailView",setup(Fe){const V=lt(),l=v(null),$=v(null),A=v(!0),u=v(!1),k=v(!1),_=v(!1),C=v(!1),w=v(!1),p=v({}),m=v({employer:"",fiscalYear:2025,grossSalary:0,taxWithheld:0,superContribution:0}),c=v({category:"WorkRelated",description:"",fiscalYear:2025,amount:0}),b=v({fundName:"",memberNumber:"",currentBalance:0,investmentOption:"Balanced",preservationDate:new Date("2050-01-01").toISOString()}),y=async()=>{try{const[a,e]=await Promise.all([f.get(`/persons/${V.params.id}`),f.get(`/persons/${V.params.id}/tax-position`)]);l.value=a.data,$.value=e.data,p.value={...a.data,dateOfBirth:a.data.dateOfBirth?.split("T")[0]}}catch(a){console.error("Failed to load person data",a)}finally{A.value=!1}},T=async()=>{u.value=!0;try{await f.put(`/persons/${l.value.id}`,p.value),k.value=!1,await y()}catch{alert("Update failed")}finally{u.value=!1}},U=()=>{_.value=!0},P=async()=>{u.value=!0;try{await f.post(`/persons/${l.value.id}/income`,m.value),_.value=!1,await y()}catch{alert("Failed to add income")}finally{u.value=!1}},R=async a=>{if(confirm("Delete this income record?"))try{await f.delete(`/persons/${l.value.id}/income/${a}`),await y()}catch{alert("Delete failed")}},M=()=>{C.value=!0},O=async()=>{u.value=!0;try{await f.post(`/persons/${l.value.id}/deductions`,c.value),C.value=!1,await y()}catch{alert("Failed to add deduction")}finally{u.value=!1}},Y=async a=>{if(confirm("Delete this deduction record?"))try{await f.delete(`/persons/${l.value.id}/deductions/${a}`),await y()}catch{alert("Delete failed")}},q=()=>{w.value=!0},E=async()=>{u.value=!0;try{await f.post(`/persons/${l.value.id}/super`,b.value),w.value=!1,await y()}catch{alert("Failed to add super account")}finally{u.value=!1}},W=async a=>{if(confirm("Delete this super account?"))try{await f.delete(`/persons/${l.value.id}/super/${a}`),await y()}catch{alert("Delete failed")}},H=a=>a<=.19?"tax-low-text":a<=.325?"tax-medium-text":"tax-high-text",G=a=>Math.min(100,a/2e5*100);return L(y),(a,e)=>{const z=st("router-link");return l.value?(n(),d("div",ot,[t("div",nt,[t("div",it,[t("div",dt,[J(z,{to:"/entities"},{default:K(()=>[...e[30]||(e[30]=[F("Entities",-1)])]),_:1}),e[31]||(e[31]=t("span",{class:"separator"},"/",-1)),t("span",rt,o(l.value.fullName),1)]),t("h1",null,o(l.value.fullName),1),t("div",ut,[t("span",vt,"ðŸŽ‚ "+o(g(at)(l.value.dateOfBirth)),1),t("span",{class:Q(["meta-item",H(l.value.marginalTaxRate)])}," ðŸ“Š "+o((l.value.marginalTaxRate*100).toFixed(1))+"% Effective Marginal Rate ",3),t("span",mt,"ðŸ›¡ï¸ "+o(l.value.hasPrivateHealthInsurance?"Private Health Insurance":"No Private Health"),1)])]),t("div",pt,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=s=>k.value=!0)},"Edit Profile")])]),t("div",ct,[t("div",bt,[t("div",ft,[t("div",{class:"section-header"},[e[32]||(e[32]=t("h2",null,"ðŸ’¼ Payroll Income",-1)),t("button",{class:"btn btn-secondary btn-sm",onClick:U},"Add Income")]),l.value.payrollIncomes?.length===0?(n(),d("div",yt," No payroll records found. ")):(n(),d("table",gt,[e[33]||(e[33]=t("thead",null,[t("tr",null,[t("th",null,"Employer"),t("th",null,"FY"),t("th",{class:"text-right"},"Gross Salary"),t("th",{class:"text-right"},"Tax Withheld"),t("th",{class:"text-right"},"Super"),t("th",{class:"text-right"},"Actions")])],-1)),t("tbody",null,[(n(!0),d(S,null,N(l.value.payrollIncomes,s=>(n(),d("tr",{key:s.id},[t("td",null,o(s.employer),1),t("td",null,"FY"+o(s.fiscalYear),1),t("td",xt,o(g(h)(s.grossSalary)),1),t("td",ht,o(g(h)(s.taxWithheld)),1),t("td",kt,o(g(h)(s.superContribution)),1),t("td",_t,[t("button",{class:"btn-icon btn-danger-text",onClick:B=>R(s.id)},"ðŸ—‘ï¸",8,Ct)])]))),128))])]))]),t("div",wt,[t("div",{class:"section-header"},[e[34]||(e[34]=t("h2",null,"ðŸ“ Deductions",-1)),t("button",{class:"btn btn-secondary btn-sm",onClick:M},"Add Deduction")]),l.value.deductions?.length===0?(n(),d("div",Dt," No deductions recorded. ")):(n(),d("table",$t,[e[35]||(e[35]=t("thead",null,[t("tr",null,[t("th",null,"Category"),t("th",null,"Description"),t("th",null,"FY"),t("th",{class:"text-right"},"Amount"),t("th",{class:"text-right"},"Actions")])],-1)),t("tbody",null,[(n(!0),d(S,null,N(l.value.deductions,s=>(n(),d("tr",{key:s.id},[t("td",null,[t("span",St,o(s.category),1)]),t("td",null,o(s.description),1),t("td",null,"FY"+o(s.fiscalYear),1),t("td",Nt,o(g(h)(s.amount)),1),t("td",Vt,[t("button",{class:"btn-icon btn-danger-text",onClick:B=>Y(s.id)},"ðŸ—‘ï¸",8,Bt)])]))),128))])]))])]),t("div",It,[t("div",Ft,[e[39]||(e[39]=t("h3",null,"âš¡ Tax Position Summary",-1)),t("div",At,[e[36]||(e[36]=t("span",{class:"label"},"Taxable Income (Est)",-1)),t("span",Tt,o(g(h)($.value?.taxableIncomeBeforeDistribution)),1)]),t("div",Ut,[e[37]||(e[37]=t("span",{class:"label"},"Total Tax (Est)",-1)),t("span",Pt,o(g(h)($.value?.taxPayableBeforeDistribution)),1)]),t("div",Rt,[e[38]||(e[38]=t("span",{class:"label"},"Marginal Bracket",-1)),t("span",Mt,o(($.value?.marginalTaxRate*100).toFixed(1))+"%",1)]),t("div",Ot,[t("div",{class:"progress-fill",style:X({width:G($.value?.taxableIncomeBeforeDistribution)+"%"})},null,4)])]),t("div",Yt,[t("div",{class:"section-header"},[e[40]||(e[40]=t("h2",null,"ðŸ¦ Superannuation",-1)),t("button",{class:"btn btn-secondary btn-sm",onClick:q},"Add Super")]),(n(!0),d(S,null,N(l.value.superAccounts,s=>(n(),d("div",{key:s.id,class:"super-item"},[t("div",qt,[t("div",Et,o(s.fundName),1),t("div",Wt,o(s.investmentOption)+" â€¢ Member "+o(s.memberNumber||"N/A"),1)]),t("div",Ht,o(g(h)(s.currentBalance)),1),t("button",{class:"btn-icon",onClick:B=>W(s.id)},"ðŸ—‘ï¸",8,Gt)]))),128)),l.value.superAccounts?.length===0?(n(),d("div",zt," No super accounts linked. ")):D("",!0)])])]),(n(),Z(et,{to:"body"},[k.value?(n(),d("div",{key:0,class:"modal-overlay",onClick:e[7]||(e[7]=x(s=>k.value=!1,["self"]))},[t("div",jt,[t("div",Lt,[e[41]||(e[41]=t("h2",null,"Edit Profile",-1)),t("button",{class:"btn-close",onClick:e[1]||(e[1]=s=>k.value=!1)},"Ã—")]),t("form",{onSubmit:x(T,["prevent"]),class:"modal-form"},[t("div",Jt,[e[42]||(e[42]=t("label",null,"Full Name",-1)),i(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>p.value.fullName=s),type:"text",required:""},null,512),[[r,p.value.fullName]])]),t("div",Kt,[e[43]||(e[43]=t("label",null,"Date of Birth",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>p.value.dateOfBirth=s),type:"date",required:""},null,512),[[r,p.value.dateOfBirth]])]),t("div",Qt,[e[45]||(e[45]=t("label",null,"Marginal Tax Rate Override",-1)),i(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>p.value.marginalTaxRate=s)},[...e[44]||(e[44]=[t("option",{value:0},"0%",-1),t("option",{value:.19},"19%",-1),t("option",{value:.3},"30%",-1),t("option",{value:.37},"37%",-1),t("option",{value:.45},"45%",-1)])],512),[[I,p.value.marginalTaxRate]])]),t("div",Xt,[t("label",Zt,[i(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>p.value.hasPrivateHealthInsurance=s)},null,512),[[tt,p.value.hasPrivateHealthInsurance]]),e[46]||(e[46]=F(" Has private health insurance ",-1))])]),t("div",te,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=s=>k.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:u.value},"Save Changes",8,ee)])],32)])])):D("",!0),_.value?(n(),d("div",{key:1,class:"modal-overlay",onClick:e[15]||(e[15]=x(s=>_.value=!1,["self"]))},[t("div",se,[t("div",le,[e[47]||(e[47]=t("h2",null,"Add Payroll Income",-1)),t("button",{class:"btn-close",onClick:e[8]||(e[8]=s=>_.value=!1)},"Ã—")]),t("form",{onSubmit:x(P,["prevent"]),class:"modal-form"},[t("div",ae,[e[48]||(e[48]=t("label",null,"Employer",-1)),i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>m.value.employer=s),type:"text",required:""},null,512),[[r,m.value.employer]])]),t("div",oe,[t("div",ne,[e[49]||(e[49]=t("label",null,"Fiscal Year",-1)),i(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>m.value.fiscalYear=s),type:"number",required:""},null,512),[[r,m.value.fiscalYear,void 0,{number:!0}]])]),t("div",ie,[e[50]||(e[50]=t("label",null,"Gross Salary",-1)),i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>m.value.grossSalary=s),type:"number",step:"0.01",required:""},null,512),[[r,m.value.grossSalary,void 0,{number:!0}]])])]),t("div",de,[t("div",re,[e[51]||(e[51]=t("label",null,"Tax Withheld",-1)),i(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>m.value.taxWithheld=s),type:"number",step:"0.01",required:""},null,512),[[r,m.value.taxWithheld,void 0,{number:!0}]])]),t("div",ue,[e[52]||(e[52]=t("label",null,"Super Guarantee",-1)),i(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>m.value.superContribution=s),type:"number",step:"0.01",required:""},null,512),[[r,m.value.superContribution,void 0,{number:!0}]])])]),t("div",ve,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[14]||(e[14]=s=>_.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:u.value},"Add Record",8,me)])],32)])])):D("",!0),C.value?(n(),d("div",{key:2,class:"modal-overlay",onClick:e[22]||(e[22]=x(s=>C.value=!1,["self"]))},[t("div",pe,[t("div",ce,[e[53]||(e[53]=t("h2",null,"Add Deduction",-1)),t("button",{class:"btn-close",onClick:e[16]||(e[16]=s=>C.value=!1)},"Ã—")]),t("form",{onSubmit:x(O,["prevent"]),class:"modal-form"},[t("div",be,[e[55]||(e[55]=t("label",null,"Category",-1)),i(t("select",{"onUpdate:modelValue":e[17]||(e[17]=s=>c.value.category=s)},[...e[54]||(e[54]=[t("option",{value:"WorkRelated"},"Work Related",-1),t("option",{value:"Investment"},"Investment Expense",-1),t("option",{value:"Donation"},"Charitable Donation",-1),t("option",{value:"Other"},"Other",-1)])],512),[[I,c.value.category]])]),t("div",fe,[e[56]||(e[56]=t("label",null,"Description",-1)),i(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>c.value.description=s),type:"text",required:""},null,512),[[r,c.value.description]])]),t("div",ye,[t("div",ge,[e[57]||(e[57]=t("label",null,"Fiscal Year",-1)),i(t("input",{"onUpdate:modelValue":e[19]||(e[19]=s=>c.value.fiscalYear=s),type:"number",required:""},null,512),[[r,c.value.fiscalYear,void 0,{number:!0}]])]),t("div",xe,[e[58]||(e[58]=t("label",null,"Amount",-1)),i(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>c.value.amount=s),type:"number",step:"0.01",required:""},null,512),[[r,c.value.amount,void 0,{number:!0}]])])]),t("div",he,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[21]||(e[21]=s=>C.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:u.value},"Add Record",8,ke)])],32)])])):D("",!0),w.value?(n(),d("div",{key:3,class:"modal-overlay",onClick:e[29]||(e[29]=x(s=>w.value=!1,["self"]))},[t("div",_e,[t("div",Ce,[e[59]||(e[59]=t("h2",null,"Add Superannuation Account",-1)),t("button",{class:"btn-close",onClick:e[23]||(e[23]=s=>w.value=!1)},"Ã—")]),t("form",{onSubmit:x(E,["prevent"]),class:"modal-form"},[t("div",we,[e[60]||(e[60]=t("label",null,"Fund Name",-1)),i(t("input",{"onUpdate:modelValue":e[24]||(e[24]=s=>b.value.fundName=s),type:"text",required:"",placeholder:"e.g. AustralianSuper"},null,512),[[r,b.value.fundName]])]),t("div",De,[t("div",$e,[e[61]||(e[61]=t("label",null,"Member Number",-1)),i(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>b.value.memberNumber=s),type:"text"},null,512),[[r,b.value.memberNumber]])]),t("div",Se,[e[62]||(e[62]=t("label",null,"Current Balance",-1)),i(t("input",{"onUpdate:modelValue":e[26]||(e[26]=s=>b.value.currentBalance=s),type:"number",step:"0.01",required:""},null,512),[[r,b.value.currentBalance,void 0,{number:!0}]])])]),t("div",Ne,[e[63]||(e[63]=t("label",null,"Investment Option",-1)),i(t("input",{"onUpdate:modelValue":e[27]||(e[27]=s=>b.value.investmentOption=s),type:"text",placeholder:"Balanced, High Growth, etc."},null,512),[[r,b.value.investmentOption]])]),t("div",Ve,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[28]||(e[28]=s=>w.value=!1)},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:u.value},"Add Account",8,Be)])],32)])])):D("",!0)]))])):D("",!0)}}},Ue=j(Ie,[["__scopeId","data-v-00ea385a"]]);export{Ue as default};
