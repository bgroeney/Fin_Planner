import{_ as H,g as p,w as M,x as P,o as l,c as o,a as t,F as _,t as n,k as i,d as B,J as L,f as b,n as w,l as f,p as z,C as O,z as d,s as k}from"./index-oVbs5Hxd.js";import{usePortfolioStore as R}from"./portfolio-CjZnfIUI.js";import{f as c,a as C,b as j}from"./formatters-DwG4QyEz.js";const J={class:"dividends-view animate-fade-in"},W={key:0,class:"loader-container"},q={class:"summary-grid"},G={class:"summary-card card"},K={class:"value-large"},Q={class:"text-muted"},X={class:"summary-card card"},Z={class:"label-text"},tt={class:"value-large value-positive"},et={class:"text-muted"},st={class:"summary-card card"},at={class:"value-large"},lt={key:0,class:"chart-section card"},ot={class:"chart-container"},nt={class:"tabs"},it={key:1,class:"table-section card"},dt={key:0,class:"data-table"},rt={class:"date-badge"},ct={class:"asset-cell"},ut={class:"asset-symbol"},vt={class:"asset-name"},mt={class:"text-right"},pt={class:"value-positive"},ht={key:0,class:"estimate-badge"},yt={key:1,class:"empty-state"},gt={key:2,class:"table-section card"},_t={class:"filter-row"},bt=["value"],ft={key:0,class:"data-table"},kt={class:"asset-cell"},xt={class:"asset-symbol"},Dt={class:"asset-name"},wt={class:"text-right value-positive"},Ct={class:"text-right"},Ft={key:1,class:"empty-state"},$t={__name:"DividendCalendarView",setup(St){const F=L,$=R(),h=p(!0),u=p("upcoming"),v=p([]),r=p([]),y=p([]),g=p(new Date().getMonth()>5?new Date().getFullYear()+1:new Date().getFullYear()),S=d(()=>g.value),m=d(()=>$.currentPortfolioId),Y=d(()=>{const s=new Date().getFullYear();return[s+1,s,s-1,s-2]}),N=d(()=>v.value.reduce((s,e)=>s+e.estimatedAmount,0)),A=d(()=>r.value.reduce((s,e)=>s+e.amount,0)),V=d(()=>r.value.reduce((s,e)=>s+e.frankingCredits,0)),E=d(()=>({chart:{type:"bar",toolbar:{show:!1},background:"transparent"},colors:["#10b981"],plotOptions:{bar:{borderRadius:4,columnWidth:"60%"}},dataLabels:{enabled:!1},xaxis:{categories:y.value.map(s=>`${s.monthName} ${s.year}`),labels:{style:{colors:"#94a3b8"}}},yaxis:{labels:{style:{colors:"#94a3b8"},formatter:s=>"$"+s.toLocaleString()}},grid:{borderColor:"rgba(255,255,255,0.1)"},tooltip:{theme:"dark",y:{formatter:s=>c(s)}}})),I=d(()=>[{name:"Dividends",data:y.value.map(s=>s.totalAmount)}]),x=async()=>{if(!m.value){h.value=!1;return}h.value=!0;try{await Promise.all([T(),D(),U()])}finally{h.value=!1}},T=async()=>{try{const s=await k.get(`/dividends/upcoming/${m.value}`);v.value=s.data}catch(s){console.error("Failed to load upcoming dividends",s),v.value=[]}},D=async()=>{try{const s=await k.get(`/dividends/history/${m.value}?fiscalYear=${g.value}`);r.value=s.data}catch(s){console.error("Failed to load dividend history",s),r.value=[]}},U=async()=>{try{const s=await k.get(`/dividends/summary/${m.value}`);y.value=s.data}catch(s){console.error("Failed to load monthly summary",s),y.value=[]}};return M(m,()=>{x()}),P(()=>{m.value?x():h.value=!1}),(s,e)=>(l(),o("div",J,[e[13]||(e[13]=t("div",{class:"header-row"},[t("div",{class:"header-content"},[t("h1",null,"Dividend Calendar"),t("p",{class:"subtitle"},"Track upcoming dividend payments and historical income")])],-1)),h.value?(l(),o("div",W,[...e[3]||(e[3]=[t("div",{class:"spinner"},null,-1)])])):(l(),o(_,{key:1},[t("div",q,[t("div",G,[e[4]||(e[4]=t("div",{class:"label-text"},"Upcoming (12 months)",-1)),t("div",K,n(i(c)(N.value)),1),t("div",Q,n(v.value.length)+" payments expected",1)]),t("div",X,[t("div",Z,"FY "+n(S.value)+" Received",1),t("div",tt,n(i(c)(A.value)),1),t("div",et,n(r.value.length)+" payments",1)]),t("div",st,[e[5]||(e[5]=t("div",{class:"label-text"},"Franking Credits",-1)),t("div",at,n(i(c)(V.value)),1),e[6]||(e[6]=t("div",{class:"text-muted"},"Tax offset available",-1))])]),y.value.length>0?(l(),o("div",lt,[e[7]||(e[7]=t("h3",null,"Monthly Dividend Income",-1)),t("div",ot,[B(i(F),{type:"bar",height:"250",options:E.value,series:I.value},null,8,["options","series"])])])):b("",!0),t("div",nt,[t("button",{class:w(["tab",{active:u.value==="upcoming"}]),onClick:e[0]||(e[0]=a=>u.value="upcoming")}," Upcoming ",2),t("button",{class:w(["tab",{active:u.value==="history"}]),onClick:e[1]||(e[1]=a=>u.value="history")}," History ",2)]),u.value==="upcoming"?(l(),o("div",it,[v.value.length>0?(l(),o("table",dt,[e[8]||(e[8]=t("thead",null,[t("tr",null,[t("th",null,"Expected Date"),t("th",null,"Asset"),t("th",null,"Units Held"),t("th",{class:"text-right"},"Est. Amount")])],-1)),t("tbody",null,[(l(!0),o(_,null,f(v.value,a=>(l(),o("tr",{key:`${a.assetId}-${a.paymentDate}`},[t("td",null,[t("span",rt,n(i(C)(a.paymentDate)),1)]),t("td",null,[t("div",ct,[t("span",ut,n(a.assetSymbol),1),t("span",vt,n(a.assetName),1)])]),t("td",null,n(i(j)(a.units)),1),t("td",mt,[t("span",pt,n(i(c)(a.estimatedAmount)),1),a.isEstimate?(l(),o("span",ht,"Est.")):b("",!0)])]))),128))])])):(l(),o("div",yt,[...e[9]||(e[9]=[t("p",null,"No upcoming dividends estimated. Add dividend-paying holdings to see projections.",-1)])]))])):b("",!0),u.value==="history"?(l(),o("div",gt,[t("div",_t,[e[10]||(e[10]=t("label",null,"Financial Year:",-1)),z(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>g.value=a),onChange:D},[(l(!0),o(_,null,f(Y.value,a=>(l(),o("option",{key:a,value:a},"FY "+n(a),9,bt))),128))],544),[[O,g.value]])]),r.value.length>0?(l(),o("table",ft,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"Date"),t("th",null,"Asset"),t("th",{class:"text-right"},"Amount"),t("th",{class:"text-right"},"Franking Credits")])],-1)),t("tbody",null,[(l(!0),o(_,null,f(r.value,a=>(l(),o("tr",{key:`${a.date}-${a.assetSymbol}`},[t("td",null,n(i(C)(a.date)),1),t("td",null,[t("div",kt,[t("span",xt,n(a.assetSymbol),1),t("span",Dt,n(a.assetName),1)])]),t("td",wt,n(i(c)(a.amount)),1),t("td",Ct,n(i(c)(a.frankingCredits)),1)]))),128))])])):(l(),o("div",Ft,[...e[12]||(e[12]=[t("p",null,"No dividend history for this financial year.",-1)])]))])):b("",!0)],64))]))}},Vt=H($t,[["__scopeId","data-v-b294937b"]]);export{Vt as default};
