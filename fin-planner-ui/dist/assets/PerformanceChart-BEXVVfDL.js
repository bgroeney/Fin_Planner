import{_ as S,r as d,k as v,C as h,i as C,c as f,o as p,a,x as D,y as B,F as I,q as P,v as A,f as L,B as y,n as V,t as M}from"./index-D_ssXn_P.js";const F={class:"performance-chart card"},Y={class:"chart-header"},$={class:"controls-row"},N={class:"benchmark-selector"},O={class:"range-selector"},T=["onClick"],z={class:"chart-container"},H={key:1,class:"empty-chart"},X={__name:"PerformanceChart",props:{portfolioId:String,benchmark:String},setup(b){const r=b,c=d("1Y"),l=d(""),_=["1M","3M","6M","1Y","3Y","5Y","ALL"],n=d([]),s=d([]),k=v(()=>n.value.length>0),g=v(()=>{const e=[{name:"Portfolio Value",data:n.value.map(t=>[new Date(t.date).getTime(),t.totalValue])}];if(s.value&&s.value.length>0){const t=n.value[0]?.totalValue||0,u=s.value[0]?.price||1,o=t/u;e.push({name:l.value,data:s.value.map(m=>[new Date(m.date).getTime(),m.price*o])})}return e}),w=v(()=>({chart:{type:"area",toolbar:{show:!1},animations:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:[3,2],dashArray:[0,5]},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.3}},xaxis:{type:"datetime",tooltip:{enabled:!1}},yaxis:{labels:{formatter:e=>"$"+(e/1e3).toFixed(1)+"k"}},theme:{mode:"dark",palette:"palette1"},colors:["#3b82f6","#9ca3af"],grid:{borderColor:"#333"},legend:{position:"top",horizontalAlign:"left"}})),i=async()=>{if(r.portfolioId)try{const e=await y.get(`/reports/performance/${r.portfolioId}`,{params:{range:c.value,benchmark:l.value}});e.data.portfolio?(n.value=e.data.portfolio,s.value=e.data.benchmark||[]):(n.value=e.data,s.value=[])}catch(e){console.error(e)}},x=async()=>{if(r.portfolioId)try{await y.post(`/reports/rebuild-history/${r.portfolioId}`),await i()}catch(e){console.error(e)}};return h(()=>r.portfolioId,i),h(l,i),h(c,i),C(i),(e,t)=>{const u=L("apexchart");return p(),f("div",F,[a("div",Y,[t[2]||(t[2]=a("h3",null,"Portfolio Performance",-1)),a("div",$,[a("div",N,[D(a("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>l.value=o),class:"form-select-sm"},[...t[1]||(t[1]=[a("option",{value:""},"No Benchmark",-1),a("option",{value:"ASX200"},"ASX 200",-1),a("option",{value:"S&P500"},"S&P 500",-1),a("option",{value:"ALLORDS"},"All Ordinaries",-1)])],512),[[B,l.value]])]),a("div",O,[(p(),f(I,null,P(_,o=>a("button",{key:o,class:V({active:c.value===o}),onClick:m=>c.value=o},M(o),11,T)),64))])])]),a("div",z,[k.value?(p(),A(u,{key:0,type:"area",height:"350",options:w.value,series:g.value},null,8,["options","series"])):(p(),f("div",H,[t[3]||(t[3]=a("p",null,"No performance data available.",-1)),a("button",{onClick:x,class:"btn btn-primary btn-sm"},"Build History")]))])])}}},E=S(X,[["__scopeId","data-v-a21bed22"]]);export{E as P};
